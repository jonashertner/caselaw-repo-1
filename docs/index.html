<!DOCTYPE html>
<html lang="de" data-theme="auto">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="5eTv5mgNKw8M8vENzS4KPG4aJKYm_zKZJhL3TbQpOGs">
<title>Swiss Case Law Open Dataset — 1M+ Court Decisions</title>
<meta name="description" content="The largest open dataset of Swiss court decisions. Over 1 million decisions from all federal courts and 26 cantons, updated daily. Search with AI, download, or query via API.">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://opencaselaw.ch/">
<meta property="og:type" content="website">
<meta property="og:url" content="https://opencaselaw.ch/">
<meta property="og:title" content="Swiss Case Law Open Dataset — 1M+ Court Decisions">
<meta property="og:description" content="The largest open dataset of Swiss court decisions. Over 1 million decisions from all federal courts and 26 cantons, updated daily. Search with AI, download, or query via API.">
<meta property="og:site_name" content="OpenCaseLaw.ch">
<meta property="og:locale" content="en_CH">
<meta property="og:locale:alternate" content="de_CH">
<meta property="og:locale:alternate" content="fr_CH">
<meta property="og:locale:alternate" content="it_CH">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Swiss Case Law Open Dataset — 1M+ Court Decisions">
<meta name="twitter:description" content="Over 1 million Swiss court decisions from all federal courts and 26 cantons. Search with AI, download, or query via API.">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Dataset",
  "name": "Swiss Case Law Open Dataset",
  "description": "The largest open dataset of Swiss court decisions. Over 1 million decisions from all federal courts and 26 cantons, updated daily.",
  "url": "https://opencaselaw.ch/",
  "license": "https://creativecommons.org/publicdomain/zero/1.0/",
  "isAccessibleForFree": true,
  "creator": {
    "@type": "Person",
    "name": "Jonas Hertner",
    "url": "https://jonashertner.com"
  },
  "distribution": [
    {
      "@type": "DataDownload",
      "encodingFormat": "application/x-parquet",
      "contentUrl": "https://huggingface.co/datasets/voilaj/swiss-caselaw"
    }
  ],
  "spatialCoverage": {
    "@type": "Place",
    "name": "Switzerland"
  },
  "temporalCoverage": "1880/..",
  "inLanguage": ["de", "fr", "it", "rm"],
  "keywords": ["Swiss law", "court decisions", "case law", "Bundesgericht", "jurisprudence", "open data", "legal dataset"]
}
</script>
<link rel="icon" type="image/svg+xml" href="favicon.svg">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root {
  --f-sans: 'IBM Plex Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
  --f-mono: 'JetBrains Mono', ui-monospace, 'SF Mono', monospace;
  --fs-2xs: 0.6875rem; --fs-xs: 0.75rem; --fs-sm: 0.8125rem;
  --fs-base: 0.875rem; --fs-md: 0.9375rem; --fs-lg: 1rem;
  --fs-xl: 1.125rem; --fs-2xl: 1.5rem; --fs-3xl: 2.5rem; --fs-4xl: 3.5rem;
  --r: 8px; --r-sm: 6px; --r-xs: 3px;
  --max-w: 1280px;
  --ease: cubic-bezier(0.4, 0, 0.2, 1);
  --bg: #ffffff; --bg2: #f7f7f8; --surf: #ffffff;
  --brd: #d4d4d4; --brd2: #e8e8ec;
  --tx: #0a0a0a; --tx2: #525252; --tx3: #a3a3a3;
  --ac: #d1242f; --ac2: #b91c1c;
  --ac-bg: rgba(0,0,0,0.025);
  --green: #16a34a; --green-bg: rgba(22,163,74,0.08);
  --chart-1: #1e40af; --chart-2: #b45309; --chart-3: #047857; --chart-4: #d1242f;
  --bar: #1e40af; --bar-hover: #3b82f6;
  --spark: #1e40af;
}
[data-theme="dark"] {
  --bg: #09090b; --bg2: #18181b; --surf: #18181b;
  --brd: #3f3f46; --brd2: #27272a;
  --tx: #fafafa; --tx2: #a1a1aa; --tx3: #71717a;
  --ac: #ef4444; --ac2: #f87171;
  --ac-bg: rgba(255,255,255,0.04);
  --green: #4ade80; --green-bg: rgba(74,222,128,0.1);
  --chart-1: #60a5fa; --chart-2: #fbbf24; --chart-3: #34d399; --chart-4: #ef4444;
  --bar: #60a5fa; --bar-hover: #93c5fd;
  --spark: #60a5fa;
}
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
html { overflow-x: hidden; scroll-behavior: smooth; }
body {
  font-family: var(--f-sans); font-size: var(--fs-md); line-height: 1.55;
  background: var(--bg); color: var(--tx);
  -webkit-font-smoothing: antialiased;
  transition: background 0.3s var(--ease), color 0.3s var(--ease);
  overflow-x: hidden;
}
.w { max-width: var(--max-w); margin: 0 auto; padding: 0 24px; }
a { color: var(--ac); text-decoration: none; }
a:hover { text-decoration: underline; }

/* ── Toolbar ── */
.toolbar {
  position: sticky; top: 0; z-index: 100;
  background: color-mix(in srgb, var(--bg) 80%, transparent);
  backdrop-filter: blur(16px) saturate(1.8); -webkit-backdrop-filter: blur(16px) saturate(1.8);
  border-bottom: 1px solid var(--brd2);
}

.toolbar-inner { display: flex; justify-content: space-between; align-items: center; height: 48px; }
.toolbar-left { display: flex; align-items: center; gap: 12px; min-width: 0; overflow: hidden; }
.toolbar-right { display: flex; align-items: center; gap: 8px; }
.lang-sw {
  display: flex; gap: 0; align-items: center;
}
.lang-sw button {
  font-family: var(--f-mono); font-size: var(--fs-2xs); font-weight: 500;
  letter-spacing: 0.04em; padding: 6px 7px; border: none;
  background: transparent; color: var(--tx3);
  cursor: pointer; transition: color 0.15s var(--ease); text-transform: uppercase;
}
.lang-sw button:hover { color: var(--tx); }
.lang-sw button.on {
  color: var(--tx); font-weight: 700;
}
.section-nav { display: flex; gap: 0; margin-left: 8px; padding-left: 12px; border-left: 1px solid var(--brd2); }
.section-nav a {
  font-size: var(--fs-2xs); font-weight: 500; color: var(--tx3);
  padding: 6px 10px; text-decoration: none;
  transition: color 0.15s var(--ease);
}
.section-nav a:hover { color: var(--tx); text-decoration: none; }
.tbtn {
  display: flex; align-items: center; justify-content: center;
  width: 32px; height: 32px; border: none;
  border-radius: var(--r-sm); background: transparent; color: var(--tx3);
  cursor: pointer; transition: color 0.15s var(--ease);
}
.tbtn:hover { color: var(--tx); }
.tbtn svg { width: 16px; height: 16px; }

/* ── Hero ── */
header { padding: 80px 0 24px; text-align: center; position: relative; }
header::before { display: none; }
header h1 {
  font-size: var(--fs-3xl); font-weight: 600;
  letter-spacing: -0.03em; line-height: 1.1;
}
header h1 .ch { color: var(--ac); }
header .sub {
  color: var(--tx2); font-size: var(--fs-md); margin-top: 10px;
  font-weight: 400; max-width: 540px; margin-left: auto; margin-right: auto;
  line-height: 1.6;
}
.hero-links {
  display: flex; gap: 8px; justify-content: center; margin-top: 24px; flex-wrap: wrap;
}
.hero-links a {
  display: inline-flex; align-items: center; gap: 6px;
  font-size: var(--fs-sm); font-weight: 500; padding: 7px 14px;
  border: 1px solid var(--brd); border-radius: 100px;
  color: var(--tx2); text-decoration: none;
  transition: all 0.2s var(--ease);
}
.hero-links a:hover { border-color: var(--tx3); color: var(--tx); background: var(--ac-bg); text-decoration: none; transform: translateY(-1px); }
.hero-links a svg { width: 14px; height: 14px; flex-shrink: 0; }

/* ── KPI ── */
.kpis {
  display: flex; justify-content: center; gap: 56px;
  margin: 36px 0 8px;
}
.kpi { text-align: center; }
.kpi-v {
  font-family: var(--f-mono); font-size: 2.25rem; font-weight: 700;
  letter-spacing: -0.03em; line-height: 1; font-variant-numeric: tabular-nums;
  color: var(--tx);
}
.kpi-l {
  font-size: var(--fs-2xs); font-weight: 600; color: var(--tx3);
  text-transform: uppercase; letter-spacing: 0.08em; margin-top: 8px;
}

/* ── Updated line ── */
.updated-line {
  text-align: center; font-size: var(--fs-xs); color: var(--tx3);
  margin-top: 12px; margin-bottom: 40px; font-family: var(--f-mono);
}

/* ── Health card (collapsible) ── */
.health-card {
  background: var(--surf); border: 1px solid var(--brd2); border-radius: var(--r);
  padding: 0; margin-bottom: 32px;
  transition: border-color 0.15s var(--ease);
}
.health-card:hover { border-color: var(--brd); }
.health-card .health-summary {
  display: flex; align-items: center; gap: 10px;
  padding: 20px 24px; cursor: pointer; list-style: none; user-select: none;
}
.health-card .health-summary::-webkit-details-marker { display: none; }
.health-card .health-summary h3 {
  font-size: var(--fs-lg); font-weight: 600; margin: 0;
}
.health-status {
  font-family: var(--f-mono); font-size: var(--fs-2xs); font-weight: 500;
  color: var(--tx3); background: var(--bg2); border: 1px solid var(--brd2);
  border-radius: 100px; padding: 2px 10px; line-height: 1.6;
}
.health-card .chevron {
  margin-left: auto; flex-shrink: 0; color: var(--tx3);
  transition: transform 0.2s var(--ease);
}
.health-card[open] .chevron { transform: rotate(180deg); }
.health-body {
  padding: 20px 24px 28px; border-top: 1px solid var(--brd2);
}

/* ── Section cards (collapsible) ── */
.section-card {
  background: var(--surf); border: 1px solid var(--brd2); border-radius: var(--r);
  padding: 0; margin-bottom: 24px;
  transition: border-color 0.15s var(--ease);
}
.section-card:hover { border-color: var(--brd); }
.section-summary {
  display: flex; align-items: center; gap: 10px;
  padding: 20px 24px; cursor: pointer; list-style: none; user-select: none;
}
.section-summary::-webkit-details-marker { display: none; }
.section-summary h2 {
  font-size: var(--fs-xl); font-weight: 600; letter-spacing: -0.01em; margin: 0;
}
.section-summary .badge {
  font-family: var(--f-mono); font-size: var(--fs-2xs); font-weight: 500;
  color: var(--tx3); background: var(--bg2); border: 1px solid var(--brd2);
  border-radius: 100px; padding: 2px 10px; line-height: 1.6;
}
.section-summary .csv-btn {
  font-size: var(--fs-2xs); font-weight: 500;
  color: var(--tx3); background: var(--bg2); border: 1px solid var(--brd2);
  border-radius: var(--r-sm); padding: 4px 10px; cursor: pointer;
  transition: all 0.15s var(--ease); font-family: var(--f-sans);
}
.section-summary .csv-btn:hover { color: var(--tx2); border-color: var(--brd); }
.section-summary .chevron {
  margin-left: auto; flex-shrink: 0; color: var(--tx3);
  transition: transform 0.2s var(--ease);
}
.section-card[open] .chevron { transform: rotate(180deg); }
.section-body {
  padding: 20px 24px 28px; border-top: 1px solid var(--brd2);
}

/* ── Hamburger & Mobile Menu ── */
.hamburger {
  display: none;
  align-items: center; justify-content: center;
  width: 32px; height: 32px; border: none;
  border-radius: var(--r-sm); background: transparent; color: var(--tx3);
  cursor: pointer; transition: color 0.15s var(--ease);
}
.hamburger:hover { color: var(--tx); }
.hamburger svg { width: 18px; height: 18px; }
.mobile-menu {
  position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 99;
  background: var(--bg);
  display: flex; align-items: center; justify-content: center;
  opacity: 0; pointer-events: none;
  transition: opacity 0.25s var(--ease);
}
.mobile-menu.open {
  opacity: 1; pointer-events: auto;
}
.mobile-menu-inner { text-align: center; }
.mobile-menu a {
  display: block; padding: 14px 0;
  font-size: var(--fs-2xl); font-weight: 500; color: var(--tx2);
  text-decoration: none; letter-spacing: -0.01em;
  transition: color 0.15s var(--ease);
}
.mobile-menu a:hover, .mobile-menu a.active { color: var(--tx); text-decoration: none; }
.section-nav a.active { color: var(--tx); font-weight: 600; }

/* ── Charts ── */
.chart-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
.chart-card {
  background: var(--surf); border: 1px solid var(--brd2); border-radius: var(--r);
  padding: 24px 24px 18px;
  transition: border-color 0.15s var(--ease);
}
.chart-card:hover { border-color: var(--brd); }
.chart-card.full-width { grid-column: 1 / -1; }
.chart-card h3 {
  font-size: var(--fs-sm); font-weight: 600; color: var(--tx2);
  text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 16px;
}
.chart-canvas { position: relative; width: 100%; }
.chart-canvas canvas { width: 100% !important; height: auto !important; }

/* Language donut */
.lang-chart-wrap { display: flex; align-items: center; gap: 24px; justify-content: center; min-height: 200px; }
.lang-legend { display: flex; flex-direction: column; gap: 8px; }
.lang-legend-item { display: flex; align-items: center; gap: 8px; font-size: var(--fs-sm); }
.lang-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
.lang-pct { font-family: var(--f-mono); font-size: var(--fs-xs); color: var(--tx3); min-width: 38px; }

/* ── Search filter ── */
.table-search {
  display: flex; align-items: center; gap: 8px; margin-bottom: 10px;
}
.table-search input {
  font-family: var(--f-sans); font-size: var(--fs-sm);
  padding: 6px 12px; border: 1px solid var(--brd2); border-radius: var(--r-sm);
  background: var(--surf); color: var(--tx); outline: none; width: 240px;
  transition: border-color 0.15s var(--ease);
}
.table-search input:focus { border-color: var(--ac); }
.table-search input::placeholder { color: var(--tx3); }
.table-search .count { font-size: var(--fs-2xs); color: var(--tx3); font-family: var(--f-mono); }

/* ── Tables ── */
.tw { border: 1px solid var(--brd2); border-radius: var(--r); overflow: hidden; overflow-x: auto; -webkit-overflow-scrolling: touch; }
.ct { width: 100%; border-collapse: collapse; }
.ct th {
  text-align: left; padding: 10px 14px; background: var(--bg2); color: var(--tx3);
  font-size: var(--fs-2xs); font-weight: 600; text-transform: uppercase;
  letter-spacing: 0.06em; border-bottom: 1px solid var(--brd2);
  cursor: pointer; user-select: none; white-space: nowrap;
  transition: color 0.15s var(--ease);
}
.ct th:hover { color: var(--tx2); }
.ct th.s { color: var(--tx); }
.ct th .arr { font-size: 0.6rem; margin-left: 2px; opacity: 0; transition: opacity 0.15s; }
.ct th.s .arr { opacity: 1; }
.ct td { padding: 10px 16px; border-top: 1px solid var(--brd2); font-size: var(--fs-base); }
.ct tbody tr:first-child td { border-top: none; }
.ct tbody tr { transition: background 0.1s; }
.ct tbody tr:hover td { background: var(--ac-bg); }
.cn { font-weight: 500; }
.cc { font-family: var(--f-mono); font-size: var(--fs-2xs); color: var(--tx3); margin-left: 5px; }
.n { font-family: var(--f-mono); font-weight: 500; font-variant-numeric: tabular-nums; }
.d { color: var(--tx2); font-variant-numeric: tabular-nums; font-size: var(--fs-sm); }
.lg {
  display: inline-block; padding: 1px 6px; border-radius: var(--r-xs);
  font-size: var(--fs-2xs); font-weight: 600; margin-right: 2px;
  background: var(--ac-bg); color: var(--tx2);
}
/* ── Canton grid ── */
.cg { display: grid; grid-template-columns: repeat(auto-fill, minmax(110px,1fr)); gap: 8px; }
.cc2 {
  background: var(--surf); border: 1px solid var(--brd2); border-radius: var(--r-sm);
  padding: 16px 6px 14px; text-align: center;
  transition: border-color 0.15s var(--ease);
}
.cc2:hover { border-color: var(--brd); }
.cc2.empty { opacity: 0.25; }
.cc2 .k { font-family: var(--f-mono); font-size: var(--fs-lg); font-weight: 700; line-height: 1; color: var(--tx); }
.cc2 .nm {
  font-size: var(--fs-2xs); color: var(--tx3); margin-top: 3px;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.cc2 .cv { font-family: var(--f-mono); font-size: var(--fs-sm); font-weight: 500; color: var(--tx2); margin-top: 6px; }
.cc2 .canton-meta {
  font-size: var(--fs-xs); color: var(--tx3); margin-top: 4px;
  display: flex; gap: 4px; justify-content: center; flex-wrap: wrap;
}
.cc2 .canton-meta .lg { font-size: var(--fs-2xs); padding: 1px 5px; margin: 0; }

/* ── Tree browser ── */
.tree { border: 1px solid var(--brd2); border-radius: var(--r); overflow: hidden; }
.tree-node {
  border-bottom: 1px solid var(--brd2); cursor: pointer;
  transition: background 0.1s var(--ease); user-select: none;
}
.tree-node:last-child { border-bottom: none; }
.tree-node:hover { background: var(--ac-bg); }
.tree-hd {
  display: flex; align-items: center; gap: 8px; padding: 8px 14px;
}
.tree-arrow {
  font-size: var(--fs-2xs); color: var(--tx3); width: 12px; text-align: center;
  transition: transform 0.15s var(--ease); flex-shrink: 0;
}
.tree-node.open > .tree-hd > .tree-arrow { transform: rotate(90deg); }
.tree-icon { font-size: var(--fs-xs); flex-shrink: 0; color: var(--ac); }
.tree-label { font-size: var(--fs-sm); font-weight: 500; flex: 1; min-width: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.tree-label .tree-code { font-family: var(--f-mono); font-size: var(--fs-2xs); color: var(--tx3); margin-left: 5px; }
.tree-count { font-family: var(--f-mono); font-size: var(--fs-sm); font-weight: 500; color: var(--tx2); white-space: nowrap; }
.tree-kids { display: none; }
.tree-node.open > .tree-kids { display: block; }
.tree-court {
  display: flex; align-items: center; gap: 8px; padding: 6px 14px 6px 38px;
  border-top: 1px solid var(--brd2); font-size: var(--fs-sm);
  transition: background 0.1s var(--ease);
}
.tree-court:hover { background: var(--ac-bg); }
.tree-court .tree-icon { font-size: var(--fs-2xs); color: var(--tx3); }
.tree-court .tree-label { font-weight: 400; color: var(--tx2); }
.tree-court .tree-count { font-size: var(--fs-xs); }

/* ── Access section ── */
.access-featured {
  background: var(--surf); border: 1px solid var(--brd2); border-radius: var(--r);
  padding: 36px 40px; margin-bottom: 20px;
}
.access-featured h3 {
  font-size: var(--fs-2xl); font-weight: 600; margin-bottom: 8px;
  letter-spacing: -0.02em;
  display: flex; align-items: center; gap: 10px;
}
.access-featured h3 svg { color: var(--tx3); }
.access-featured > p { font-size: var(--fs-base); color: var(--tx2); margin-bottom: 28px; line-height: 1.65; max-width: 720px; }
.access-featured .setup-paths {
  display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 28px;
}
.access-featured .setup-path h4 {
  font-size: var(--fs-sm); font-weight: 600; margin-bottom: 6px;
  display: flex; align-items: center; gap: 6px;
}
.access-featured .setup-path .setup-steps {
  font-size: var(--fs-xs); color: var(--tx2); line-height: 1.7;
}
.access-featured .setup-path code {
  display: block; font-family: var(--f-mono); font-size: var(--fs-xs);
  background: var(--bg2); border: 1px solid var(--brd2); border-radius: var(--r-sm);
  padding: 10px 14px; overflow-x: auto; white-space: pre; color: var(--tx2);
  line-height: 1.6; margin-top: 8px;
}
.access-featured .example-prompts {
  border-top: 1px solid var(--brd2); padding-top: 24px; margin-top: 4px;
}
.access-featured .example-prompts h5 {
  font-size: var(--fs-2xs); font-weight: 700; color: var(--tx3); margin-bottom: 14px;
  text-transform: uppercase; letter-spacing: 0.06em;
}
.access-featured .prompt-list {
  list-style: none; padding: 0; margin: 0;
  display: grid; grid-template-columns: 1fr 1fr; gap: 0;
}
.access-featured .prompt-list li {
  font-size: var(--fs-sm); color: var(--tx2);
  padding: 10px 0 10px 16px; border-top: 1px solid var(--brd2);
  line-height: 1.5; position: relative;
}
.access-featured .prompt-list li:nth-child(-n+2) { border-top: none; }
.access-featured .prompt-list li::before {
  content: ''; position: absolute; left: 0; top: 17px;
  width: 4px; height: 4px; border-radius: 50%; background: var(--tx3);
}
.access-featured .setup-path-label {
  font-size: var(--fs-2xs); font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.06em; color: var(--tx3); margin-bottom: 10px;
  display: flex; align-items: center; gap: 6px;
}
.access-featured .setup-path-label .rec {
  color: var(--green); font-weight: 700;
}
.access-featured .plan-note {
  font-size: var(--fs-2xs); color: var(--tx3); margin-top: 10px; line-height: 1.5;
}
.access-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 16px; margin-top: 4px; }
.access-card {
  background: var(--surf); border: 1px solid var(--brd2); border-radius: var(--r);
  padding: 24px;
  transition: border-color 0.15s var(--ease);
  min-width: 0;
}
.access-card:hover { border-color: var(--brd); }
.access-card h3 {
  font-size: var(--fs-md); font-weight: 600; margin-bottom: 8px;
  display: flex; align-items: center; gap: 8px;
}
.access-card h3 svg { color: var(--tx3); }
.access-card p { font-size: var(--fs-sm); color: var(--tx2); margin-bottom: 14px; line-height: 1.5; }
.access-card code {
  display: block; font-family: var(--f-mono); font-size: var(--fs-xs);
  background: var(--bg2); border: 1px solid var(--brd2); border-radius: var(--r-sm);
  padding: 12px 14px; overflow-x: auto; white-space: pre; color: var(--tx2);
  line-height: 1.6;
}

/* ── Footer ── */
footer {
  text-align: center; padding: 48px 0 64px; color: var(--tx3);
  font-size: var(--fs-xs); border-top: 1px solid var(--brd2);
  margin-top: 48px;
}
footer a { color: var(--tx2); }
footer a:hover { color: var(--ac); }
footer .foot-links { display: flex; gap: 20px; justify-content: center; margin-bottom: 10px; }
footer .foot-links a {
  font-weight: 500; text-decoration: none; padding: 4px 0;
  border-bottom: 1px solid transparent; transition: all 0.15s var(--ease);
}
footer .foot-links a:hover { border-bottom-color: var(--ac); text-decoration: none; }

/* ── States ── */
.ld { text-align: center; padding: 32px 0; color: var(--tx3); font-size: var(--fs-base); }
.sp {
  display: inline-block; width: 14px; height: 14px;
  border: 2px solid var(--brd); border-top-color: var(--tx);
  border-radius: 50%; animation: spin 0.6s linear infinite;
  margin-right: 8px; vertical-align: -2px;
}
@keyframes spin { to { transform: rotate(360deg); } }
.delta { font-size: var(--fs-2xs); font-family: var(--f-mono); color: var(--green);
  background: var(--green-bg); padding: 1px 6px; border-radius: 9px; margin-left: 6px; white-space: nowrap; }
.pill { display:inline-block; padding:2px 8px; border-radius:10px; font-size:var(--fs-xs); font-weight:600; }
.pill-ok { background:#22863a22; color:var(--green); }
.pill-fail { background:#d1242f22; color:var(--ac); }
.pill-stale { background:#dbab0922; color:#b08800; }
.pill-investigating { background:#dbab0922; color:#b08800; }
.pill-running { background:#0969da22; color:#0969da; }
[data-theme="dark"] .pill-ok { background:#22863a33; }
[data-theme="dark"] .pill-fail { background:#d1242f33; }
[data-theme="dark"] .pill-stale { background:#dbab0933; color:#d4a017; }
[data-theme="dark"] .pill-investigating { background:#dbab0933; color:#d4a017; }
[data-theme="dark"] .pill-running { background:#0969da33; color:#58a6ff; }
.health-meta { font-size:var(--fs-sm); color:var(--tx2); font-family:var(--f-mono); margin-bottom:12px; }
.disk-bar { margin-bottom:16px; font-size:var(--fs-sm); color:var(--tx2); font-family:var(--f-mono); }
.disk-bar .disk-track { height:8px; background:var(--bd); border-radius:4px; margin:4px 0 2px; overflow:hidden; }
.disk-bar .disk-fill { height:100%; border-radius:4px; transition:width .3s; }
.disk-bar .disk-fill.ok { background:var(--green); }
.disk-bar .disk-fill.warn { background:#d4a017; }
.disk-bar .disk-fill.critical { background:var(--ac); }
.hid { display: none !important; }

/* ── Study guide ── */
.study-card {
  background: var(--surf); border: 1px solid var(--brd2); border-radius: var(--r);
  padding: 36px 40px; margin-bottom: 32px;
}
.study-card:hover { border-color: var(--brd); }
.study-card h3 {
  font-size: var(--fs-2xl); font-weight: 600; margin-bottom: 8px;
  letter-spacing: -0.02em;
  display: flex; align-items: center; gap: 10px;
}
.study-card h3 svg { color: var(--tx3); flex-shrink: 0; }
.study-card > p { font-size: var(--fs-base); color: var(--tx2); margin-bottom: 28px; line-height: 1.65; max-width: 720px; }
.study-steps {
  display: flex; flex-direction: column; gap: 0; margin-bottom: 24px;
  counter-reset: study-step;
}
.study-step {
  display: grid; grid-template-columns: 36px 1fr; gap: 16px;
  padding: 16px 0; border-bottom: 1px solid var(--brd2);
  position: relative;
}
.study-step:last-child { border-bottom: none; }
.study-step-num {
  width: 32px; height: 32px; border-radius: 50%;
  background: var(--tx); color: var(--bg); font-family: var(--f-mono);
  font-size: var(--fs-sm); font-weight: 700;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0; margin-top: 0;
}
.study-step-content {}
.study-step-title { font-size: var(--fs-md); font-weight: 600; margin-bottom: 3px; }
.study-step-desc { font-size: var(--fs-sm); color: var(--tx2); line-height: 1.5; }
.study-step-desc code {
  font-family: var(--f-mono); font-size: var(--fs-xs);
  background: var(--bg2); border: 1px solid var(--brd2); border-radius: var(--r-xs);
  padding: 2px 6px; color: var(--tx2);
}
.study-step-desc a { font-weight: 500; }
.study-prompts {
  border-top: 1px solid var(--brd2); padding-top: 24px;
}
.study-prompts h5 {
  font-size: var(--fs-2xs); font-weight: 700; color: var(--tx3); margin-bottom: 14px;
  text-transform: uppercase; letter-spacing: 0.06em;
}
.study-prompts ul {
  list-style: none; padding: 0; margin: 0;
  display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
}
.study-prompts li {
  font-size: var(--fs-xs); color: var(--tx2); font-family: var(--f-mono);
  padding: 10px 14px; background: var(--bg2);
  border: 1px solid var(--brd2); border-radius: var(--r-sm);
  line-height: 1.5;
}
.study-areas {
  margin-top: 18px; display: flex; flex-wrap: wrap; gap: 8px;
}
.study-area-tag {
  font-size: var(--fs-2xs); font-weight: 500; color: var(--tx2);
  background: var(--bg2); border: 1px solid var(--brd2);
  border-radius: 100px; padding: 3px 10px; line-height: 1.4;
}

/* ── Responsive ── */
@media (max-width: 768px) {
  .hamburger { display: flex; }
  .chart-row { grid-template-columns: 1fr; }
  .access-grid { grid-template-columns: 1fr; }
  .access-featured .setup-paths { grid-template-columns: 1fr; }
  .access-featured { padding: 24px 18px; }
  .access-featured .prompt-list { grid-template-columns: 1fr; }
  .access-featured .prompt-list li:nth-child(-n+2) { border-top: 1px solid var(--brd2); }
  .access-featured .prompt-list li:first-child { border-top: none; }
  .section-summary { padding: 16px 18px; }
  .section-body { padding: 16px 18px 20px; }
  .health-card .health-summary { padding: 16px 18px; }
  .health-body { padding: 16px 18px 20px; }
  .study-prompts ul { grid-template-columns: 1fr; }
  .study-card { padding: 24px 18px; }
  .kpis { gap: 40px; }
  .section-nav { display: none; }
}
@media (max-width: 640px) {
  .w { padding: 0 16px; }
  header { padding: 48px 0 12px; }
  header h1 { font-size: 1.75rem; }
  header::before { width: 100%; }
  .kpis { gap: 36px; margin: 28px 0 4px; }
  .kpi-v { font-size: 1.75rem; }
  .cg { grid-template-columns: repeat(auto-fill, minmax(80px,1fr)); }
  .tw { margin: 0 -16px; border-radius: 0; border-left: none; border-right: none; box-shadow: none; }
  .ct th, .ct td { padding: 8px 10px; }
  .ct .hide-m { display: none; }
  .ct td:first-child { max-width: 200px; }
  .cn { display: inline-block; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; vertical-align: middle; }
  .hero-links a { font-size: var(--fs-xs); padding: 6px 10px; }
  .lang-chart-wrap { flex-direction: column; }
  .table-search input { width: 100%; }
  .access-card code { font-size: 0.6875rem; }
  .tree-court { padding-left: 24px; }
}
@media (max-width: 380px) {
  .w { padding: 0 12px; }
  .kpi-v { font-size: 1.5rem; }
  .kpis { gap: 20px; flex-wrap: wrap; }
  .cg { grid-template-columns: repeat(4,1fr); gap: 6px; }
  .cc2 { padding: 10px 4px 8px; }
  .cc2 .k { font-size: var(--fs-md); }
  .cc2 .nm { font-size: 0.625rem; }
  .cc2 .cv { font-size: var(--fs-xs); }
  .cn { max-width: 120px; }
  .ct th, .ct td { padding: 6px 8px; font-size: var(--fs-xs); }
  .toolbar-inner { height: 40px; }
  .lang-sw button { padding: 2px 5px; font-size: 0.625rem; }
  .hero-links { gap: 6px; }
  .hero-links a { padding: 5px 8px; font-size: 0.625rem; }
  header h1 { font-size: 1.4rem; }
  .tree-hd { padding: 6px 10px; }
  .tree-court { padding: 5px 10px 5px 20px; }
}

/* ── Copy buttons ── */
.copy-wrap { position: relative; }
.copy-btn {
  position: absolute; top: 6px; right: 6px;
  font-family: var(--f-sans); font-size: var(--fs-2xs); font-weight: 600;
  padding: 3px 10px; border: 1px solid var(--brd2); border-radius: var(--r-xs);
  background: var(--surf); color: var(--tx3); cursor: pointer;
  opacity: 0; transition: all 0.15s var(--ease); text-transform: uppercase;
  letter-spacing: 0.04em;
}
.copy-wrap:hover .copy-btn { opacity: 1; }
.copy-btn:hover { color: var(--tx); border-color: var(--brd); }
</style>
</head>
<body>

<nav class="toolbar"><div class="w toolbar-inner">
  <div class="toolbar-left">
    <div class="lang-sw" role="group" aria-label="Language">
      <button data-l="de" class="on">DE</button>
      <button data-l="fr">FR</button>
      <button data-l="it">IT</button>
      <button data-l="rm">RM</button>
      <button data-l="en">EN</button>
    </div>
    <div class="section-nav" id="section-nav">
      <a href="#kpis" data-t="nav_overview">Overview</a>
      <a href="#sec-access" data-t="nav_access">Access</a>
      <a href="#sec-coverage" data-t="nav_coverage">Coverage</a>
      <a href="#sec-fed" data-t="nav_federal">Federal</a>
      <a href="#sec-can" data-t="nav_cantonal">Cantonal</a>
      <a href="#sec-cantons" data-t="nav_cantons">Cantons</a>
      <a href="#sec-tree" data-t="nav_browse">Browse</a>
      <a href="#sec-study" data-t="nav_study">Study</a>
    </div>
  </div>
  <div class="toolbar-right">
    <button class="hamburger" id="hamburger-btn" aria-label="Menu">
      <svg class="ico-menu" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M3 6h18M3 12h18M3 18h18"/></svg>
      <svg class="ico-close" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" style="display:none"><path d="M18 6L6 18M6 6l12 12"/></svg>
    </button>
    <button class="tbtn" id="theme-btn" aria-label="Toggle theme">
      <svg id="ico-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
      <svg id="ico-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:none"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
    </button>
  </div>
</div></nav>

<div class="mobile-menu" id="mobile-menu">
  <div class="mobile-menu-inner">
    <a href="#kpis" data-t="nav_overview">Overview</a>
    <a href="#sec-access" data-t="nav_access">Access</a>
    <a href="#sec-coverage" data-t="nav_coverage">Coverage</a>
    <a href="#sec-fed" data-t="nav_federal">Federal</a>
    <a href="#sec-can" data-t="nav_cantonal">Cantonal</a>
    <a href="#sec-cantons" data-t="nav_cantons">Cantons</a>
    <a href="#sec-tree" data-t="nav_browse">Browse</a>
    <a href="#sec-study" data-t="nav_study">Study</a>
  </div>
</div>

<div class="w">

  <header>
    <h1><span class="ch">+</span> <span data-t="title">Swiss Case Law Open Dataset</span></h1>
    <p class="sub" data-t="subtitle">The largest open dataset of Swiss court decisions from all federal courts and 26 cantons. Download and search locally with AI tools.</p>
    <div class="hero-links">
      <a href="https://huggingface.co/datasets/voilaj/swiss-caselaw">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>
        HuggingFace Dataset
      </a>
      <a href="https://github.com/jonashertner/caselaw-repo-1">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z"/></svg>
        GitHub
      </a>
      <a href="#sec-access">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
        <span data-t="hero_mcp">Search with AI</span>
      </a>
    </div>
  </header>

  <div class="kpis" id="kpis">
    <div class="ld" style="grid-column:1/-1"><span class="sp"></span> <span data-t="loading">Loading</span></div>
  </div>

  <!-- Last Updated -->
  <div class="updated-line hid" id="last-updated"></div>

  <!-- Access the Data -->
  <details class="section-card" id="sec-access" open>
    <summary class="section-summary">
      <h2 data-t="access">Access the Data</h2>
      <svg class="chevron" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </summary>
    <div class="section-body">
      <!-- Featured: Search with AI -->
      <div class="access-featured">
        <h3>
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/><path d="M8 8l1.5 1.5M14.5 8l-1 1" stroke-linecap="round"/></svg>
          <span data-t="access_featured_title">Search with AI</span>
        </h3>
        <p data-t="access_featured_desc">Über 1 Million Schweizer Gerichtsentscheide in natürlicher Sprache durchsuchen. Relevante Urteile finden, Zitationen zwischen Entscheiden nachverfolgen, Rechtsprechungstrends analysieren und Recherche-Notizen erstellen.</p>
        <div class="setup-paths">
          <div class="setup-path">
            <div class="setup-path-label"><span class="rec" data-t="access_remote_label">Remote (recommended)</span></div>
            <div class="setup-steps"><span data-t="access_remote_desc">Instant, always current. No download needed.</span></div>
            <div class="setup-steps" style="margin-top:10px">
              <strong data-t="access_setup_desktop">Claude Desktop</strong><br>
              <span style="color:var(--tx2);font-size:var(--fs-xs)">Settings → Connectors → Add →</span><br>
              <code>https://mcp.opencaselaw.ch</code>
            </div>
            <div class="setup-steps" style="margin-top:10px">
              <strong data-t="access_setup_code">Claude Code</strong>
              <code>claude mcp add swiss-caselaw \
  --transport sse \
  https://mcp.opencaselaw.ch</code>
            </div>
            <div class="setup-steps" style="margin-top:10px">
              <strong>ChatGPT</strong><br>
              <span style="color:var(--tx2);font-size:var(--fs-xs)" data-t="access_chatgpt_steps">Settings → Connectors → Developer Mode → Create →</span><br>
              <code>https://mcp.opencaselaw.ch</code>
            </div>
            <div class="setup-steps" style="margin-top:10px">
              <strong>Gemini CLI</strong>
              <code>// ~/.gemini/settings.json
{ "mcpServers": {
    "swiss-caselaw": {
      "url": "https://mcp.opencaselaw.ch"
    }
}}</code>
            </div>
            <div class="plan-note" data-t="access_plan_note">Claude: Pro, Max, Team, or Enterprise (Desktop) / any plan (Code). ChatGPT: Plus, Pro, Team, or Enterprise. Gemini CLI: free.</div>
          </div>
          <div class="setup-path">
            <div class="setup-path-label" data-t="access_local_label">Local (offline)</div>
            <div class="setup-steps"><span data-t="access_local_desc">Full control, works offline. ~65 GB disk, 30&ndash;60 min setup.</span></div>
            <div class="setup-steps" style="margin-top:10px">
              <span style="color:var(--tx2);font-size:var(--fs-xs)" data-t="access_local_clone">Clone → install → register with any MCP client</span><br>
              <a href="https://github.com/jonashertner/caselaw-repo-1#option-b-local-server-offline-access" style="font-size:var(--fs-xs)" data-t="access_local_setup">Full setup guide →</a>
            </div>
            <div class="setup-steps" style="margin-top:10px;font-size:var(--fs-xs);color:var(--tx3)" data-t="access_local_note">
              Works with any MCP client. Local mode includes database update tools.
            </div>
          </div>
        </div>
        <div class="example-prompts">
          <h5 data-t="examples_heading">Was nach der Verbindung möglich ist:</h5>
          <ul class="prompt-list">
            <li data-t="cap_search">Entscheide in natürlicher Sprache suchen — nach Stichwort, Thema, Gesetzesartikel oder Rechtskonzept</li>
            <li data-t="cap_lookup">Jeden Entscheid per Dossiernummer abrufen — mit Volltext und Metadaten</li>
            <li data-t="cap_stats">Statistiken und Abdeckung aller Bundes- und Kantonsgerichte einsehen</li>
            <li data-t="cap_leading">Leitentscheide zu jedem Gesetz oder Rechtsgebiet finden, nach Zitationshäufigkeit geordnet</li>
            <li data-t="cap_citations">Zitationsnetzwerke nachverfolgen — sehen, was ein Entscheid zitiert und was ihn zitiert</li>
            <li data-t="cap_trends">Analysieren, wie sich die Rechtsprechung zu einem Thema über die Jahre entwickelt hat</li>
            <li data-t="cap_research">Recherche-Notizen aus Sachverhalt erstellen — mit passender Rechtsprechung und Gesetzesartikeln</li>
            <li data-t="cap_study">Leitentscheide interaktiv studieren mit geführten Übungen und Urteilsbesprechungen</li>
          </ul>
        </div>
      </div>
      <!-- Standard cards: 3-col -->
      <div class="access-grid">
        <div class="access-card">
          <h3>
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>
            <span data-t="quick_download">Download</span>
          </h3>
          <p data-t="access_hf_desc">Download the full dataset as Parquet files</p>
          <code>from datasets import load_dataset
ds = load_dataset("voilaj/swiss-caselaw")</code>
        </div>
        <div class="access-card">
          <h3>
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
            REST API
          </h3>
          <p data-t="access_api_desc">Query via HuggingFace Datasets Server API</p>
          <code>GET /rows?dataset=voilaj/swiss-caselaw
  &config=default&split=train
  &offset=0&length=10</code>
        </div>
        <div class="access-card">
          <h3>
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            Web UI
          </h3>
          <p data-t="access_webui_desc">Local chat interface — ask questions in natural language, get answers with cited decisions. Runs on your machine with Claude, OpenAI, Gemini, or local models via Ollama (no API key needed).</p>
          <code>git clone github.com/jonashertner/caselaw-repo-1
cd caselaw-repo-1
./scripts/run_web_local.sh</code>
        </div>
      </div>
    </div>
  </details>

  <!-- Coverage (charts) -->
  <details class="section-card" id="sec-coverage" open>
    <summary class="section-summary">
      <h2 data-t="nav_coverage">Coverage</h2>
      <svg class="chevron" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </summary>
    <div class="section-body">
      <div class="chart-row" id="charts">
        <div class="chart-card">
          <h3 data-t="chart_timeline">Decisions per Year</h3>
          <div class="chart-canvas"><canvas id="c-timeline" height="220"></canvas></div>
        </div>
        <div class="chart-card">
          <h3 data-t="chart_languages">Language Distribution</h3>
          <div class="lang-chart-wrap">
            <div class="chart-canvas" style="max-width:180px"><canvas id="c-lang" height="180"></canvas></div>
            <div class="lang-legend" id="lang-legend"></div>
          </div>
        </div>
      </div>
    </div>
  </details>

  <!-- Federal courts -->
  <details class="section-card hid" id="sec-fed">
    <summary class="section-summary">
      <h2 data-t="federal">Federal Courts</h2>
      <span class="badge" id="fed-n"></span>
      <svg class="chevron" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </summary>
    <div class="section-body">
      <div class="tw">
        <table class="ct" id="t-fed"><thead><tr>
          <th data-k="name" data-t="th_court">Court</th>
          <th data-k="count" data-t="th_decisions">Decisions</th>
          <th data-k="last_scraped" class="hide-m" data-t="th_updated">New Data</th>
          <th data-k="languages" data-t="th_languages">Languages</th>
        </tr></thead><tbody></tbody></table>
      </div>
    </div>
  </details>

  <!-- Cantonal courts -->
  <details class="section-card hid" id="sec-can">
    <summary class="section-summary">
      <h2 data-t="cantonal">Cantonal Courts</h2>
      <span class="badge" id="can-n"></span>
      <button class="csv-btn" id="csv-can" data-t="csv_export">CSV</button>
      <svg class="chevron" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </summary>
    <div class="section-body">
    <div class="table-search" id="can-search-wrap">
      <input type="text" id="can-search" data-t-placeholder="search_placeholder" placeholder="Search courts...">
      <span class="count" id="can-search-count"></span>
    </div>
    <div class="tw">
      <table class="ct" id="t-can"><thead><tr>
        <th data-k="name" data-t="th_court">Court</th>
        <th data-k="canton" data-t="th_canton">Canton</th>
        <th data-k="count" data-t="th_decisions">Decisions</th>
        <th data-k="last_scraped" class="hide-m" data-t="th_updated">New Data</th>
      </tr></thead><tbody></tbody></table>
    </div>
    </div>
  </details>

  <!-- Canton grid -->
  <details class="section-card hid" id="sec-cantons">
    <summary class="section-summary">
      <h2 data-t="cantons">Cantons</h2>
      <svg class="chevron" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </summary>
    <div class="section-body">
      <div class="cg" id="canton-grid"></div>
    </div>
  </details>

  <!-- Tree browser -->
  <details class="section-card hid" id="sec-tree">
    <summary class="section-summary">
      <h2 data-t="browse">Browse</h2>
      <svg class="chevron" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </summary>
    <div class="section-body">
      <div class="tree" id="tree-browser"></div>
    </div>
  </details>

  <!-- Study Guide -->
  <details class="section-card" id="sec-study">
    <summary class="section-summary">
      <h2 data-t="study_title">Study Swiss Law</h2>
      <span class="badge">44 BGE</span>
      <svg class="chevron" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </summary>
    <div class="section-body">
    <div class="study-card">
      <h3>
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        <span data-t="study_heading">BGE-Leitentscheide interaktiv erarbeiten</span>
      </h3>
      <p data-t="study_intro">44 ausgew&auml;hlte BGE in 8 Rechtsgebieten &mdash; Regeste, Erw&auml;gungen und Dispositiv strukturiert aufbereitet. Subsumtions&uuml;bungen, Urteilsbesprechung nach Schweizer Methodik und Variationen zur Pr&uuml;fungsvorbereitung.</p>

      <div class="study-steps">
        <div class="study-step">
          <div class="study-step-num">1</div>
          <div class="study-step-content">
            <div class="study-step-title" data-t="study_s1_title">Connect to the MCP server</div>
            <div class="study-step-desc" data-t="study_s1_desc">Open <a href="https://claude.ai">claude.ai</a> (Pro/Max/Team) &rarr; Settings &rarr; Connectors &rarr; Add &rarr; <code>https://mcp.opencaselaw.ch</code></div>
          </div>
        </div>
        <div class="study-step">
          <div class="study-step-num">2</div>
          <div class="study-step-content">
            <div class="study-step-title" data-t="study_s2_title">Rechtsgebiet w&auml;hlen</div>
            <div class="study-step-desc" data-t="study_s2_desc">Frage Claude: <code>Zeige mir das Studienangebot</code> &mdash; du siehst alle Rechtsgebiete von OR AT &uuml;ber Sachenrecht bis Strafrecht AT. Oder springe direkt zu einem BGE.</div>
          </div>
        </div>
        <div class="study-step">
          <div class="study-step-num">3</div>
          <div class="study-step-content">
            <div class="study-step-title" data-t="study_s3_title">BGE durcharbeiten</div>
            <div class="study-step-desc" data-t="study_s3_desc">Frage: <code>Ich m&ouml;chte den Leitentscheid zu Art. 41 OR studieren</code>. Du erh&auml;ltst Regeste, Sachverhalt, nummerierte Erw&auml;gungen mit Gesetzesverweisen und Dispositiv &mdash; plus Leitfragen von Verst&auml;ndnis bis kritischer W&uuml;rdigung.</div>
          </div>
        </div>
        <div class="study-step">
          <div class="study-step-num">4</div>
          <div class="study-step-content">
            <div class="study-step-title" data-t="study_s4_title">Urteilsbesprechung schreiben</div>
            <div class="study-step-desc" data-t="study_s4_desc">Schreibe deine Besprechung nach der 6-teiligen Vorlage: Leitsatz, Rechtsatz mit Auslegung, rechtserheblicher Sachverhalt, Kernerw&auml;gungen (Subsumtion), Dispositiv und pr&auml;judizielle Bedeutung. Claude gibt dir kriterienbasiertes Feedback.</div>
          </div>
        </div>
        <div class="study-step">
          <div class="study-step-num">5</div>
          <div class="study-step-content">
            <div class="study-step-title" data-t="study_s5_title">Vertiefen und repetieren</div>
            <div class="study-step-desc" data-t="study_s5_desc">Diskutiere Sachverhaltsvariationen &mdash; was &auml;ndert sich am Ergebnis, wenn ein Tatbestandselement wegf&auml;llt? Nutze Repetitionskarten mit Rechts&auml;tzen und Anwendungsbeispielen f&uuml;r die Pr&uuml;fungsvorbereitung.</div>
          </div>
        </div>
      </div>

      <div class="study-prompts">
        <h5 data-t="study_prompts_heading">Example prompts</h5>
        <ul>
          <li data-t="study_p1">Zeige mir die BGE zum Vertragsrecht (OR AT)</li>
          <li data-t="study_p2">Ich m&ouml;chte BGE 144 III 93 durcharbeiten</li>
          <li data-t="study_p3">Erkl&auml;re mir die Subsumtion in Art. 41 OR</li>
          <li data-t="study_p4">Hier ist meine Urteilsbesprechung &mdash; Feedback?</li>
          <li data-t="study_p5">Was w&auml;re, wenn der Sch&auml;diger nicht widerrechtlich gehandelt h&auml;tte?</li>
          <li data-t="study_p6">Repetitionskarten f&uuml;r die Voraussetzungen der Gesch&auml;ftsf&uuml;hrung ohne Auftrag</li>
        </ul>
      </div>

      <div class="study-areas">
        <span class="study-area-tag">Vertragsrecht</span>
        <span class="study-area-tag">Haftpflicht</span>
        <span class="study-area-tag">Sachenrecht</span>
        <span class="study-area-tag">Grundrechte</span>
        <span class="study-area-tag">Strafrecht AT</span>
        <span class="study-area-tag">Mietrecht</span>
        <span class="study-area-tag">Arbeitsrecht</span>
        <span class="study-area-tag">Familienrecht</span>
      </div>
    </div>
    </div>
  </details>

  <!-- Scraper Health (collapsible) -->
  <details class="health-card hid" id="sec-health">
    <summary class="health-summary">
      <h3 data-t="health_title">Scraper Health</h3>
      <span class="health-status" id="health-summary-status"></span>
      <svg class="chevron" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </summary>
    <div class="health-body">
      <div class="health-meta hid" id="health-meta"></div>
      <div class="disk-bar hid" id="disk-bar"></div>
      <div class="tw">
        <table class="ct" id="t-health"><thead><tr>
          <th data-k="name" data-t="th_court">Court</th>
          <th data-k="status" data-t="th_status">Status</th>
          <th data-k="new_count" data-t="th_new">New</th>
          <th data-k="duration_s" data-t="th_duration">Duration</th>
          <th data-k="state_count" class="hide-m" data-t="th_state">Total Known</th>
          <th data-k="jsonl_size_mb" class="hide-m" data-t="th_jsonl_size">JSONL</th>
          <th data-k="jsonl_mtime" class="hide-m" data-t="th_last_data">Last Data</th>
        </tr></thead><tbody></tbody></table>
      </div>
    </div>
  </details>

  <footer>
    <div class="foot-links">
      <a href="https://huggingface.co/datasets/voilaj/swiss-caselaw">HuggingFace</a>
      <a href="https://github.com/jonashertner/caselaw-repo-1">GitHub</a>
    </div>
    <div id="ts"></div>
    <div style="margin-top:4px" data-t="made">Built with &#9829; by <a href="https://jonashertner.com">Jonas Hertner</a></div>
    <div style="margin-top:4px" data-t="contact">Questions or feedback? <a href="mailto:team@jonashertner.com">team@jonashertner.com</a></div>
  </footer>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
<script>
const I18N = {
  de: {
    title:'Swiss Case Law Open Dataset',
    subtitle:'Der gr\u00f6sste offene Datensatz Schweizer Gerichtsentscheide aller Bundesgerichte und 26 Kantone. Sofort mit AI durchsuchen oder den gesamten Datensatz herunterladen.',
    loading:'Laden', kpi_decisions:'Entscheide', kpi_courts:'Gerichte', kpi_cantons:'Kantone', kpi_languages:'Sprachen', kpi_coverage:'Zeitraum',
    federal:'Bund', cantonal:'Kantone', cantons:'Kantone', access:'Datenzugang',
    th_court:'Gericht', th_canton:'Kanton', th_decisions:'Entscheide', th_updated:'Neue Daten', th_languages:'Sprachen',
    chart_timeline:'Entscheide pro Jahr', chart_languages:'Sprachverteilung',
    chart_top10:'Top 10 Gerichte', chart_lang_trends:'Sprachtrends (2005\u2013heute)',
    updated:'Aktualisiert am',
    made:'Gebaut mit \u2665 von <a href="https://jonashertner.com">Jonas Hertner</a>',
    contact:'Fragen oder Feedback? <a href="mailto:team@jonashertner.com">team@jonashertner.com</a>',
    access_hf_desc:'Gesamter Datensatz als Parquet-Dateien herunterladen',
    access_api_desc:'Abfragen via HuggingFace Datasets Server API',
    browse:'Durchsuchen',
    nav_overview:'\u00dcbersicht', nav_coverage:'Abdeckung', nav_federal:'Bund', nav_cantonal:'Kantonal', nav_cantons:'Kantone', nav_browse:'Durchsuchen', nav_access:'Zugang',
    search_placeholder:'Gerichte suchen...', csv_export:'CSV',
    quick_webui:'Web UI', quick_webui_desc:'Chat-Oberfl\u00e4che \u2014 Fragen stellen, Entscheide erhalten',
    quick_download:'Download', quick_download_desc:'Kompletter Datensatz zum Download auf HuggingFace',
    quick_search:'Mit AI durchsuchen', quick_search_desc:'Fragen in natürlicher Sprache stellen — Einrichtung in 30 Sekunden',
    quick_api:'API', quick_api_desc:'Den Datensatz programmatisch via REST API abfragen',
    access_webui_desc:'Lokale Chat-Oberfl\u00e4che \u2014 Fragen in nat\u00fcrlicher Sprache stellen, Antworten mit zitierten Entscheiden erhalten. L\u00e4uft lokal mit Claude, OpenAI, Gemini oder lokalen Modellen via Ollama (kein API-Schl\u00fcssel n\u00f6tig).',
    access_featured_title:'Mit AI durchsuchen',
    access_featured_desc:'Über 1 Million Schweizer Gerichtsentscheide in natürlicher Sprache durchsuchen. Relevante Urteile finden, Zitationen zwischen Entscheiden nachverfolgen, Rechtsprechungstrends analysieren und Recherche-Notizen erstellen.',
    access_setup_desktop:'Claude Desktop',
    access_setup_code:'Claude Code',
    access_remote_label:'Remote (empfohlen)', access_local_label:'Lokal (offline)',
    access_remote_desc:'Sofort verf\u00fcgbar, immer aktuell. Kein Download n\u00f6tig.',
    access_local_desc:'Volle Kontrolle, offline verf\u00fcgbar. ~65 GB Speicher, 30\u201360 Min. Einrichtung.',
    access_chatgpt_steps:'Settings → Connectors → Developer Mode → Create →',
    access_plan_note:'Claude: Pro, Max, Team oder Enterprise (Desktop) / jeder Plan (Code). ChatGPT: Plus, Pro, Team oder Enterprise. Gemini CLI: kostenlos.',
    access_local_note:'Kompatibel mit jedem MCP-Client. Lokaler Modus enthält Datenbank-Update-Tools.',
    access_local_clone:'Klonen → installieren → mit beliebigem MCP-Client registrieren',
    access_local_setup:'Vollständige Einrichtung →',
    examples_heading:'Was nach der Verbindung möglich ist:',
    cap_search:'Entscheide in natürlicher Sprache suchen — nach Stichwort, Thema, Gesetzesartikel oder Rechtskonzept',
    cap_lookup:'Jeden Entscheid per Dossiernummer abrufen — mit Volltext und Metadaten',
    cap_stats:'Statistiken und Abdeckung aller Bundes- und Kantonsgerichte einsehen',
    cap_leading:'Leitentscheide zu jedem Gesetz oder Rechtsgebiet finden, nach Zitationshäufigkeit geordnet',
    cap_citations:'Zitationsnetzwerke nachverfolgen — sehen, was ein Entscheid zitiert und was ihn zitiert',
    cap_trends:'Analysieren, wie sich die Rechtsprechung zu einem Thema über die Jahre entwickelt hat',
    cap_research:'Recherche-Notizen aus Sachverhalt erstellen — mit passender Rechtsprechung und Gesetzesartikeln',
    cap_study:'Leitentscheide interaktiv studieren mit geführten Übungen und Urteilsbesprechungen',
    nav_study:'Studium',
    study_title:'Schweizer Recht studieren',
    study_heading:'BGE-Leitentscheide interaktiv erarbeiten',
    study_intro:'44 ausgewählte BGE in 8 Rechtsgebieten — Regeste, Erwägungen und Dispositiv strukturiert aufbereitet. Subsumtionsübungen, Urteilsbesprechung nach Schweizer Methodik und Variationen zur Prüfungsvorbereitung.',
    study_s1_title:'Mit dem MCP-Server verbinden',
    study_s1_desc:'Öffne <a href="https://claude.ai">claude.ai</a> (Pro/Max/Team) → Settings → Connectors → Add → <code>https://mcp.opencaselaw.ch</code>',
    study_s2_title:'Rechtsgebiet wählen',
    study_s2_desc:'Frage Claude: <code>Zeige mir das Studienangebot</code> — du siehst alle Rechtsgebiete von OR AT über Sachenrecht bis Strafrecht AT. Oder springe direkt zu einem BGE.',
    study_s3_title:'BGE durcharbeiten',
    study_s3_desc:'Frage: <code>Ich möchte den Leitentscheid zu Art. 41 OR studieren</code>. Du erhältst Regeste, Sachverhalt, nummerierte Erwägungen mit Gesetzesverweisen und Dispositiv — plus Leitfragen von Verständnis bis kritischer Würdigung.',
    study_s4_title:'Urteilsbesprechung schreiben',
    study_s4_desc:'Schreibe deine Besprechung nach der 6-teiligen Vorlage: Leitsatz, Rechtsatz mit Auslegung, rechtserheblicher Sachverhalt, Kernerwägungen (Subsumtion), Dispositiv und präjudizielle Bedeutung. Claude gibt dir kriterienbasiertes Feedback.',
    study_s5_title:'Vertiefen und repetieren',
    study_s5_desc:'Diskutiere Sachverhaltsvariationen — was ändert sich am Ergebnis, wenn ein Tatbestandselement wegfällt? Nutze Repetitionskarten mit Rechtssätzen und Anwendungsbeispielen für die Prüfungsvorbereitung.',
    study_prompts_heading:'Beispiel-Prompts',
    study_p1:'Zeige mir die BGE zum Vertragsrecht (OR AT)',
    study_p2:'Ich möchte BGE 144 III 93 durcharbeiten',
    study_p3:'Erkläre mir die Subsumtion in Art. 41 OR',
    study_p4:'Hier ist meine Urteilsbesprechung — Feedback?',
    study_p5:'Was wäre, wenn der Schädiger nicht widerrechtlich gehandelt hätte?',
    study_p6:'Repetitionskarten für die Voraussetzungen der Geschäftsführung ohne Auftrag',
    hero_mcp:'Mit AI durchsuchen',
    nav_health:'Status', health_title:'Scraper-Status', th_status:'Status', th_new:'Neu', th_duration:'Dauer', th_state:'Bekannt', th_jsonl_size:'JSONL', th_last_data:'Letzte Daten', health_run_at:'Letzter Lauf', health_ok:'OK', health_fail:'Fehler', health_investigating:'In Abkl\u00e4rung', health_running:'L\u00e4uft noch', health_stale:'Veraltet', health_errors:'Fehler', health_unavail:'\u00fcbersprungen', health_unavail_tip:'Entscheide im Portal-Index aufgef\u00fchrt, aber Inhalt nicht abrufbar (leere Seite oder fehlendes PDF)', health_disk:'Speicher', health_disk_free:'frei',
  },
  fr: {
    title:'Swiss Case Law Open Dataset',
    subtitle:'Le plus grand jeu de donn\u00e9es ouvert de d\u00e9cisions judiciaires suisses de tous les tribunaux f\u00e9d\u00e9raux et 26 cantons. Recherchez instantan\u00e9ment avec l\u2019IA ou t\u00e9l\u00e9chargez le jeu de donn\u00e9es complet.',
    loading:'Chargement', kpi_decisions:'D\u00e9cisions', kpi_courts:'Tribunaux', kpi_cantons:'Cantons', kpi_languages:'Langues', kpi_coverage:'P\u00e9riode',
    federal:'F\u00e9d\u00e9ral', cantonal:'Cantons', cantons:'Cantons', access:'Acc\u00e8s aux donn\u00e9es',
    th_court:'Tribunal', th_canton:'Canton', th_decisions:'D\u00e9cisions', th_updated:'Nouvelles donn\u00e9es', th_languages:'Langues',
    chart_timeline:'D\u00e9cisions par ann\u00e9e', chart_languages:'R\u00e9partition linguistique',
    chart_top10:'Top 10 Tribunaux', chart_lang_trends:'Tendances linguistiques (depuis 2005)',
    updated:'Mis \u00e0 jour le',
    made:'Fait avec \u2665 par <a href="https://jonashertner.com">Jonas Hertner</a>',
    contact:'Questions ou commentaires ? <a href="mailto:team@jonashertner.com">team@jonashertner.com</a>',
    access_hf_desc:'T\u00e9l\u00e9charger le jeu de donn\u00e9es complet en Parquet',
    access_api_desc:'Requ\u00eates via HuggingFace Datasets Server API',
    browse:'Parcourir',
    nav_overview:'Aper\u00e7u', nav_coverage:'Couverture', nav_federal:'F\u00e9d\u00e9ral', nav_cantonal:'Cantonal', nav_cantons:'Cantons', nav_browse:'Parcourir', nav_access:'Acc\u00e8s',
    search_placeholder:'Rechercher...', csv_export:'CSV',
    quick_webui:'Web UI', quick_webui_desc:'Interface de chat \u2014 posez des questions, obtenez des d\u00e9cisions',
    quick_download:'Télécharger', quick_download_desc:'Dataset complet à télécharger sur HuggingFace',
    quick_search:'Recherche avec IA', quick_search_desc:'Posez des questions en langage naturel — configuration en 30 secondes',
    quick_api:'API', quick_api_desc:'Interroger le dataset par programmation via l\'API REST',
    access_webui_desc:'Interface de chat locale \u2014 posez des questions en langage naturel, obtenez des r\u00e9ponses avec des d\u00e9cisions cit\u00e9es. Fonctionne sur votre machine avec Claude, OpenAI, Gemini ou des mod\u00e8les locaux via Ollama (sans cl\u00e9 API).',
    access_featured_title:'Recherche avec IA',
    access_featured_desc:'Recherchez plus d\'un million de décisions judiciaires suisses en langage naturel. Trouvez les arrêts pertinents, tracez les citations entre décisions, analysez les tendances jurisprudentielles et rédigez des notes de recherche.',
    access_setup_desktop:'Claude Desktop',
    access_setup_code:'Claude Code',
    access_remote_label:'Distant (recommand\u00e9)', access_local_label:'Local (hors ligne)',
    access_remote_desc:'Instantan\u00e9, toujours \u00e0 jour. Aucun t\u00e9l\u00e9chargement n\u00e9cessaire.',
    access_local_desc:'Contr\u00f4le total, fonctionne hors ligne. ~65 Go, 30\u201360 min d\u2019installation.',
    access_chatgpt_steps:'Settings → Connectors → Developer Mode → Create →',
    access_plan_note:'Claude : Pro, Max, Team ou Enterprise (Desktop) / tout plan (Code). ChatGPT : Plus, Pro, Team ou Enterprise. Gemini CLI : gratuit.',
    access_local_note:'Compatible avec tout client MCP. Le mode local inclut les outils de mise à jour de la base de données.',
    access_local_clone:'Cloner → installer → enregistrer avec un client MCP',
    access_local_setup:'Guide d\'installation complet →',
    examples_heading:'Ce qui est possible après connexion :',
    cap_search:'Rechercher des décisions en langage naturel — par mot-clé, sujet, article de loi ou concept juridique',
    cap_lookup:'Consulter toute décision par numéro de dossier — avec texte intégral et métadonnées',
    cap_stats:'Consulter les statistiques et la couverture de tous les tribunaux fédéraux et cantonaux',
    cap_leading:'Trouver les arrêts de référence pour toute loi ou domaine juridique, classés par nombre de citations',
    cap_citations:'Suivre les réseaux de citations — voir ce qu\'une décision cite et ce qui la cite',
    cap_trends:'Analyser comment la jurisprudence sur un sujet a évolué au fil des années',
    cap_research:'Rédiger des notes de recherche à partir de faits — avec jurisprudence et articles de loi pertinents',
    cap_study:'Étudier les arrêts de référence de manière interactive avec des exercices guidés et des commentaires d\'arrêt',
    nav_study:'Études',
    study_title:'Étudier le droit suisse',
    study_heading:'Travailler les ATF de principe de manière interactive',
    study_intro:'44 ATF sélectionnés dans 8 domaines — regeste, considérants numérotés avec références légales et dispositif. Exercices de subsomption, commentaire d\'arrêt selon la méthode suisse et variations pour la préparation aux examens.',
    study_s1_title:'Se connecter au serveur MCP',
    study_s1_desc:'Ouvrir <a href="https://claude.ai">claude.ai</a> (Pro/Max/Team) → Settings → Connectors → Add → <code>https://mcp.opencaselaw.ch</code>',
    study_s2_title:'Choisir un domaine',
    study_s2_desc:'Demandez à Claude : <code>Montre-moi le programme d\'études</code> — vous voyez tous les domaines, du CO PG aux droits réels en passant par le droit pénal PG. Ou allez directement à un ATF.',
    study_s3_title:'Analyser un ATF',
    study_s3_desc:'Demandez : <code>Je voudrais étudier l\'arrêt de principe sur l\'art. 41 CO</code>. Vous recevez regeste, état de fait, considérants numérotés avec renvois légaux et dispositif — plus des questions allant de la compréhension à l\'appréciation critique.',
    study_s4_title:'Rédiger un commentaire d\'arrêt',
    study_s4_desc:'Suivez le modèle en 6 sections : ratio decidendi, règle de droit et interprétation, faits juridiquement pertinents, considérants clés (subsomption), dispositif et portée jurisprudentielle. Claude vous donne un feedback critérié.',
    study_s5_title:'Approfondir et réviser',
    study_s5_desc:'Discutez des variations de l\'état de fait — qu\'est-ce qui change si une condition tombe? Utilisez les cartes de révision avec les règles de droit et exemples d\'application pour préparer l\'examen.',
    study_prompts_heading:'Exemples de prompts',
    study_p1:'Montre-moi les ATF en droit des contrats (CO PG)',
    study_p2:'Je voudrais travailler l\'ATF 144 III 93',
    study_p3:'Explique-moi la subsomption de l\'art. 41 CO',
    study_p4:'Voici mon commentaire d\'arrêt — feedback?',
    study_p5:'Et si l\'auteur n\'avait pas agi de manière illicite?',
    study_p6:'Cartes de révision sur les conditions de la gestion d\'affaires sans mandat',
    hero_mcp:'Recherche avec IA',
    nav_health:'Sant\u00e9', health_title:'Sant\u00e9 des scrapers', th_status:'Statut', th_new:'Nouveaux', th_duration:'Dur\u00e9e', th_state:'Total connu', th_jsonl_size:'JSONL', th_last_data:'Derni\u00e8res donn\u00e9es', health_run_at:'Dernier passage', health_ok:'OK', health_fail:'\u00c9chec', health_investigating:'En cours', health_running:'En cours', health_stale:'P\u00e9rim\u00e9', health_errors:'erreurs', health_unavail:'ignor\u00e9s', health_unavail_tip:'D\u00e9cisions list\u00e9es dans l\u2019index du portail mais contenu non t\u00e9l\u00e9chargeable (page vide ou PDF manquant)', health_disk:'Stockage', health_disk_free:'libre',
  },
  it: {
    title:'Swiss Case Law Open Dataset',
    subtitle:'Il pi\u00f9 grande dataset aperto di decisioni giudiziarie svizzere di tutti i tribunali federali e 26 cantoni. Cerca istantaneamente con l\u2019IA o scarica il dataset completo.',
    loading:'Caricamento', kpi_decisions:'Decisioni', kpi_courts:'Tribunali', kpi_cantons:'Cantoni', kpi_languages:'Lingue', kpi_coverage:'Periodo',
    federal:'Federale', cantonal:'Cantoni', cantons:'Cantoni', access:'Accesso ai dati',
    th_court:'Tribunale', th_canton:'Cantone', th_decisions:'Decisioni', th_updated:'Nuovi dati', th_languages:'Lingue',
    chart_timeline:'Decisioni per anno', chart_languages:'Distribuzione linguistica',
    chart_top10:'Top 10 Tribunali', chart_lang_trends:'Tendenze linguistiche (dal 2005)',
    updated:'Aggiornato il',
    made:'Fatto con \u2665 da <a href="https://jonashertner.com">Jonas Hertner</a>',
    contact:'Domande o feedback? <a href="mailto:team@jonashertner.com">team@jonashertner.com</a>',
    access_hf_desc:'Scarica il dataset completo in formato Parquet',
    access_api_desc:'Query via HuggingFace Datasets Server API',
    browse:'Sfoglia',
    nav_overview:'Panoramica', nav_coverage:'Copertura', nav_federal:'Federale', nav_cantonal:'Cantonale', nav_cantons:'Cantoni', nav_browse:'Sfoglia', nav_access:'Accesso',
    search_placeholder:'Cerca tribunali...', csv_export:'CSV',
    quick_webui:'Web UI', quick_webui_desc:'Interfaccia chat \u2014 fai domande, ottieni decisioni',
    quick_download:'Download', quick_download_desc:'Dataset completo da scaricare su HuggingFace',
    quick_search:'Ricerca con IA', quick_search_desc:'Fai domande in linguaggio naturale — configurazione in 30 secondi',
    quick_api:'API', quick_api_desc:'Interroga il dataset via API REST',
    access_webui_desc:'Interfaccia chat locale \u2014 fai domande in linguaggio naturale, ottieni risposte con decisioni citate. Funziona sulla tua macchina con Claude, OpenAI, Gemini o modelli locali via Ollama (senza chiave API).',
    access_featured_title:'Ricerca con IA',
    access_featured_desc:'Cerca oltre un milione di decisioni giudiziarie svizzere in linguaggio naturale. Trova sentenze pertinenti, traccia le citazioni tra decisioni, analizza le tendenze giurisprudenziali e redigi note di ricerca.',
    access_setup_desktop:'Claude Desktop',
    access_setup_code:'Claude Code',
    access_remote_label:'Remoto (consigliato)', access_local_label:'Locale (offline)',
    access_remote_desc:'Istantaneo, sempre aggiornato. Nessun download necessario.',
    access_local_desc:'Controllo completo, funziona offline. ~65 GB, 30\u201360 min di installazione.',
    access_chatgpt_steps:'Settings → Connectors → Developer Mode → Create →',
    access_plan_note:'Claude: Pro, Max, Team o Enterprise (Desktop) / qualsiasi piano (Code). ChatGPT: Plus, Pro, Team o Enterprise. Gemini CLI: gratuito.',
    access_local_note:'Compatibile con qualsiasi client MCP. La modalità locale include strumenti di aggiornamento del database.',
    access_local_clone:'Clonare → installare → registrare con un client MCP',
    access_local_setup:'Guida all\'installazione completa →',
    examples_heading:'Cosa è possibile dopo la connessione:',
    cap_search:'Cercare decisioni in linguaggio naturale — per parola chiave, tema, articolo di legge o concetto giuridico',
    cap_lookup:'Consultare qualsiasi decisione per numero di dossier — con testo integrale e metadati',
    cap_stats:'Consultare statistiche e copertura di tutti i tribunali federali e cantonali',
    cap_leading:'Trovare le decisioni guida per ogni legge o area giuridica, ordinate per numero di citazioni',
    cap_citations:'Tracciare le reti di citazioni — vedere cosa cita una decisione e cosa la cita',
    cap_trends:'Analizzare come la giurisprudenza su un tema si è evoluta nel corso degli anni',
    cap_research:'Redigere note di ricerca a partire dai fatti — con giurisprudenza e articoli di legge pertinenti',
    cap_study:'Studiare le decisioni guida in modo interattivo con esercizi guidati e commenti',
    nav_study:'Studio',
    study_title:'Studiare il diritto svizzero',
    study_heading:'Analizzare le DTF di principio in modo interattivo',
    study_intro:'44 DTF selezionate in 8 aree — regesto, considerandi numerati con riferimenti legislativi e dispositivo. Esercizi di sussunzione, commento di sentenza secondo il metodo svizzero e variazioni per la preparazione agli esami.',
    study_s1_title:'Connettersi al server MCP',
    study_s1_desc:'Aprire <a href="https://claude.ai">claude.ai</a> (Pro/Max/Team) → Settings → Connectors → Add → <code>https://mcp.opencaselaw.ch</code>',
    study_s2_title:'Scegliere un\'area giuridica',
    study_s2_desc:'Chiedi a Claude: <code>Mostrami il programma di studio</code> — vedrai tutte le aree, dal CO PG ai diritti reali al diritto penale PG. Oppure vai direttamente a una DTF.',
    study_s3_title:'Analizzare una DTF',
    study_s3_desc:'Chiedi: <code>Vorrei studiare la decisione di principio sull\'art. 41 CO</code>. Ricevi regesto, fattispecie, considerandi numerati con rinvii legislativi e dispositivo — più domande dalla comprensione alla valutazione critica.',
    study_s4_title:'Scrivere un commento di sentenza',
    study_s4_desc:'Segui il modello in 6 sezioni: ratio decidendi, regola giuridica e interpretazione, fatti giuridicamente rilevanti, considerandi chiave (sussunzione), dispositivo e portata giurisprudenziale. Claude ti dà un feedback basato su criteri.',
    study_s5_title:'Approfondire e ripetere',
    study_s5_desc:'Discuti variazioni della fattispecie — cosa cambia se viene meno un elemento della fattispecie? Usa le carte di ripetizione con le regole giuridiche e gli esempi applicativi per preparare l\'esame.',
    study_prompts_heading:'Esempi di prompt',
    study_p1:'Mostrami le DTF sul diritto contrattuale (CO PG)',
    study_p2:'Vorrei analizzare la DTF 144 III 93',
    study_p3:'Spiegami la sussunzione dell\'art. 41 CO',
    study_p4:'Ecco il mio commento di sentenza — feedback?',
    study_p5:'E se il danneggiante non avesse agito illecitamente?',
    study_p6:'Carte di ripetizione sui presupposti della gestione d\'affari senza mandato',
    hero_mcp:'Ricerca con IA',
    nav_health:'Salute', health_title:'Stato dei scraper', th_status:'Stato', th_new:'Nuovi', th_duration:'Durata', th_state:'Totale noto', th_jsonl_size:'JSONL', th_last_data:'Ultimi dati', health_run_at:'Ultima esecuzione', health_ok:'OK', health_fail:'Errore', health_investigating:'In esame', health_running:'In esecuzione', health_stale:'Obsoleto', health_errors:'errori', health_unavail:'saltati', health_unavail_tip:'Decisioni elencate nell\u2019indice del portale ma contenuto non scaricabile (pagina vuota o PDF mancante)', health_disk:'Archiviazione', health_disk_free:'libero',
  },
  rm: {
    title:'Swiss Case Law Open Dataset',
    subtitle:'Il pli grond set da datas avert da decisiuns giudizialas svizras da tut las dretgiras federalas e 26 chantuns. Tschertgar directamain cun IA u telechargiar il set da datas cumplain.',
    loading:'Chargiar', kpi_decisions:'Decisiuns', kpi_courts:'Dretgiras', kpi_cantons:'Chantuns', kpi_languages:'Linguas', kpi_coverage:'Perioda',
    federal:'Federal', cantonal:'Chantuns', cantons:'Chantuns', access:'Access a las datas',
    th_court:'Dretgira', th_canton:'Chantun', th_decisions:'Decisiuns', th_updated:'Datas novas', th_languages:'Linguas',
    chart_timeline:'Decisiuns per onn', chart_languages:'Distribuziun linguistica',
    chart_top10:'Top 10 Dretgiras', chart_lang_trends:'Tendenzas linguisticas (dapi 2005)',
    updated:'Actualis\u00e0 ils',
    made:'Constru\u00ec cun \u2665 da <a href="https://jonashertner.com">Jonas Hertner</a>',
    contact:'Dumondas u resun? <a href="mailto:team@jonashertner.com">team@jonashertner.com</a>',
    access_hf_desc:'Telechargiar il set da datas cumplain sco datotecas Parquet',
    access_api_desc:'Dumondas via HuggingFace Datasets Server API',
    browse:'Navigar',
    nav_overview:'Survista', nav_coverage:'Cuvretga', nav_federal:'Federal', nav_cantonal:'Chantunal', nav_cantons:'Chantuns', nav_browse:'Navigar', nav_access:'Access',
    search_placeholder:'Tschertgar dretgiras...', csv_export:'CSV',
    quick_webui:'Web UI', quick_webui_desc:'Interfatscha da chat \u2014 far dumondas, obtegnir decisiuns',
    quick_download:'Telechargiar', quick_download_desc:'Set da datas cumplain per telechargiar sin HuggingFace',
    quick_search:'Tschertgar cun IA', quick_search_desc:'Far dumondas en lingua natirala — configuraziun en 30 secundas',
    quick_api:'API', quick_api_desc:'Dumandar il set da datas programmaticamain via API REST',
    access_webui_desc:'Interfatscha da chat locala \u2014 far dumondas en lingua natirala, obtegnir respostas cun decisiuns citadas. Funcziuna sin tes computer cun Claude, OpenAI, Gemini u models locals via Ollama (senza clav API).',
    access_featured_title:'Tschertgar cun IA',
    access_featured_desc:'Tschertgar sur 1 milliun decisiuns giudizialas svizras en lingua natirala. Chattar sentenziuns relevantas, persequitar citaziuns tranter decisiuns, analisar tendenzas giurisprudenzialas e rediger notizias da perscrutaziun.',
    access_setup_desktop:'Claude Desktop',
    access_setup_code:'Claude Code',
    access_remote_label:'Remote (recumandà)', access_local_label:'Local (offline)',
    access_remote_desc:'Direct disponibel, adina actual. Nagin download necessari.',
    access_local_desc:'Controlla cumplaina, funcziuna offline. ~65 GB, 30\u201360 min installaziun.',
    access_chatgpt_steps:'Settings → Connectors → Developer Mode → Create →',
    access_plan_note:'Claude: Pro, Max, Team u Enterprise (Desktop) / mintga plan (Code). ChatGPT: Plus, Pro, Team u Enterprise. Gemini CLI: gratuit.',
    access_local_note:'Cumpatibl cun mintga client MCP. Il modus local cuntegna utensils per actualisar la banca da datas.',
    access_local_clone:'Clonar → installar → registrar cun in client MCP',
    access_local_setup:'Guida d\'installaziun cumplaina →',
    examples_heading:'Tge ch\'è pussaivel suenter la connexiun:',
    cap_search:'Tschertgar decisiuns en lingua natirala — tenor plaid-clav, tema, artitgel da lescha u concept giuridic',
    cap_lookup:'Retscherchar mintga decisiun per numer da dossier — cun text cumplain e metadatas',
    cap_stats:'Consultar statisticas e cuvretga da tut las dretgiras federalas e chantunals',
    cap_leading:'Chattar decisiuns directivas per mintga lescha u champ giuridic, ordinadas tenor dumber da citaziuns',
    cap_citations:'Persequitar raits da citaziuns — vesair tge ch\'ina decisiun cita e tge che la cita',
    cap_trends:'Analisar co la giurisprudenza ad in tema ha sa sviluppà sur ils onns',
    cap_research:'Rediger notizias da perscrutaziun ord fatgs — cun giurisprudenza ed artitgels da lescha pertinents',
    cap_study:'Studiar decisiuns directivas interactivamain cun exercizis guidads e commentaris',
    nav_study:'Studi',
    study_title:'Studiar il dretg svizzer',
    study_heading:'Elavurar las DTF da princip en moda interactiva',
    study_intro:'44 DTF selecziunadas en 8 champs — regest, considerands numerads cun referenzas legalas e dispositiv. Exercizis da subsumziun, commentari da sentenzia tenor la metoda svizra e variaziuns per la preparaziun d\'examen.',
    study_s1_title:'Sa colliar cun il server MCP',
    study_s1_desc:'Avrir <a href="https://claude.ai">claude.ai</a> (Pro/Max/Team) → Settings → Connectors → Add → <code>https://mcp.opencaselaw.ch</code>',
    study_s2_title:'Tscherner in champ giuridic',
    study_s2_desc:'Dumandar a Claude: <code>Mussar il program da studi</code> — ti vesas tut ils champs, dal CO PG als dretgs reals fin al dretg penal PG. U ir directamain ad ina DTF.',
    study_s3_title:'Analisar ina DTF',
    study_s3_desc:'Dumandar: <code>Jau less studiar la decisiun da princip davart l\'art. 41 CO</code>. Ti retschaivas regest, fatgs, considerands numerads cun rinvias legalas e dispositiv — plus dumondas da la chapientscha fin a la valitaziun critica.',
    study_s4_title:'Scriver in commentari da sentenzia',
    study_s4_desc:'Suandar il model en 6 secziuns: ratio decidendi, regla giuridica ed interpretaziun, fatgs giuridicamain relevants, considerands centrals (subsumziun), dispositiv e purschida giurisprudenziala. Claude dat in feedback structurà.',
    study_s5_title:'Approfundar e repeter',
    study_s5_desc:'Discutar variaziuns dals fatgs — tge sa mida sch\'in element da la fattispeche manca? Utilisar las cartas da repetiziun cun reglas giuridicas ed exemples d\'applicaziun per preparar l\'examen.',
    study_prompts_heading:'Exemples da prompts',
    study_p1:'Mussar las DTF dal dretg contractual (CO PG)',
    study_p2:'Jau less elavurar la DTF 144 III 93',
    study_p3:'Explitgar la subsumziun da l\'art. 41 CO',
    study_p4:'Qua è mes commentari da sentenzia — feedback?',
    study_p5:'E sche il donnegiader n\'avess betg agì illicitamain?',
    study_p6:'Cartas da repetiziun per las premissas da la gestiun d\'affars senza incumbensa',
    hero_mcp:'Tschertgar cun IA',
    nav_health:'Sanadad', health_title:'Status dals scrapers', th_status:'Status', th_new:'Novs', th_duration:'Durada', th_state:'Total enconuschent', th_jsonl_size:'JSONL', th_last_data:'Ultimas datas', health_run_at:'Ultima execuziun', health_ok:'OK', health_fail:'Errur', health_investigating:'En examinaziun', health_running:'Anc en funcziun', health_stale:'Vegl', health_errors:'errurs', health_unavail:'sursiglids', health_unavail_tip:'Decisiuns menziunadas en l\u2019index dal portal ma cuntegn betg telechargabel (pagina vida u PDF che manca)', health_disk:'Memoria', health_disk_free:'liber',
  },
  en: {
    title:'Swiss Case Law Open Dataset',
    subtitle:'The largest open dataset of Swiss court decisions from all federal courts and 26 cantons. Search instantly with AI or download the full dataset.',
    loading:'Loading', kpi_decisions:'Decisions', kpi_courts:'Courts', kpi_cantons:'Cantons', kpi_languages:'Languages', kpi_coverage:'Coverage',
    federal:'Federal', cantonal:'Cantonal', cantons:'Cantons', access:'Access the Data',
    th_court:'Court', th_canton:'Canton', th_decisions:'Decisions', th_updated:'New Data', th_languages:'Languages',
    chart_timeline:'Decisions per Year', chart_languages:'Language Distribution',
    chart_top10:'Top 10 Courts', chart_lang_trends:'Language Trends (since 2005)',
    updated:'Updated',
    made:'Built with \u2665 by <a href="https://jonashertner.com">Jonas Hertner</a>',
    contact:'Questions or feedback? <a href="mailto:team@jonashertner.com">team@jonashertner.com</a>',
    access_hf_desc:'Download the full dataset as Parquet files',
    access_api_desc:'Query via HuggingFace Datasets Server API',
    browse:'Browse',
    nav_overview:'Overview', nav_coverage:'Coverage', nav_federal:'Federal', nav_cantonal:'Cantonal', nav_cantons:'Cantons', nav_browse:'Browse', nav_access:'Access',
    search_placeholder:'Search courts...', csv_export:'CSV',
    quick_webui:'Web UI', quick_webui_desc:'Chat interface \u2014 ask questions, get cited decisions',
    quick_download:'Download', quick_download_desc:'Full dataset for download on HuggingFace',
    quick_search:'Search with AI', quick_search_desc:'Ask questions in natural language — setup takes 30 seconds',
    quick_api:'API', quick_api_desc:'Query the dataset programmatically via REST API',
    access_webui_desc:'Local chat interface \u2014 ask questions in natural language, get answers with cited decisions. Runs on your machine with Claude, OpenAI, Gemini, or local models via Ollama (no API key needed).',
    access_featured_title:'Search with AI',
    access_featured_desc:'Search over 1 million Swiss court decisions in natural language. Find relevant cases, trace citations between decisions, analyze legal trends, and draft research memos.',
    access_setup_desktop:'Claude Desktop',
    access_setup_code:'Claude Code',
    access_remote_label:'Remote (recommended)', access_local_label:'Local (offline)',
    access_remote_desc:'Instant, always current. No download needed.',
    access_local_desc:'Full control, works offline. ~65 GB disk, 30\u201360 min setup.',
    access_chatgpt_steps:'Settings → Connectors → Developer Mode → Create →',
    access_plan_note:'Claude: Pro, Max, Team, or Enterprise (Desktop) / any plan (Code). ChatGPT: Plus, Pro, Team, or Enterprise. Gemini CLI: free.',
    access_local_note:'Works with any MCP client. Local mode includes database update tools.',
    access_local_clone:'Clone → install → register with any MCP client',
    access_local_setup:'Full setup guide →',
    examples_heading:'What you can do after connecting:',
    cap_search:'Search decisions in natural language — by keyword, topic, statute, or legal concept',
    cap_lookup:'Look up any decision by docket number — with full text and metadata',
    cap_stats:'View statistics and coverage across all federal and cantonal courts',
    cap_leading:'Find leading cases for any law or legal area, ranked by citation count',
    cap_citations:'Trace citation networks — see what a decision cites and what cites it',
    cap_trends:'Analyze how jurisprudence on a topic has evolved year by year',
    cap_research:'Draft research memos from case facts — with relevant case law and statutes',
    cap_study:'Study leading cases interactively with guided exercises and case briefing',
    nav_study:'Study',
    study_title:'Study Swiss Law',
    study_heading:'Work through BGE leading cases interactively',
    study_intro:'44 selected BGE across 8 areas — Regeste, numbered Erw\u00e4gungen with statutory references, and Dispositiv. Subsumtion exercises, Urteilsbesprechung (case commentary) using Swiss methodology, and fact-pattern variations for exam prep.',
    study_s1_title:'Connect to the MCP server',
    study_s1_desc:'Open <a href="https://claude.ai">claude.ai</a> (Pro/Max/Team) &rarr; Settings &rarr; Connectors &rarr; Add &rarr; <code>https://mcp.opencaselaw.ch</code>',
    study_s2_title:'Choose an area of law',
    study_s2_desc:'Ask Claude: <code>Show me the study curriculum</code> \u2014 you\'ll see all areas from OR AT (contract law) to Sachenrecht (property) to Strafrecht AT (criminal law). Or jump straight to a BGE.',
    study_s3_title:'Work through a BGE',
    study_s3_desc:'Ask: <code>I\'d like to study the leading case on Art. 41 OR</code>. You get Regeste, Sachverhalt, numbered Erw\u00e4gungen with statutory cross-references, and Dispositiv \u2014 plus guided questions from comprehension to critical evaluation.',
    study_s4_title:'Write a case commentary',
    study_s4_desc:'Follow the 6-section template: ratio decidendi, Rechtsatz (legal rule + interpretation), legally relevant facts, key Erw\u00e4gungen (Subsumtion), Dispositiv, and precedential significance. Claude gives you criteria-based feedback.',
    study_s5_title:'Deepen and review',
    study_s5_desc:'Discuss fact-pattern variations \u2014 how does the outcome change if a Tatbestandselement (constituent element) drops away? Use review cards with Rechtss\u00e4tze and application examples for exam prep.',
    study_prompts_heading:'Example prompts',
    study_p1:'Show me the BGE for contract law (OR AT)',
    study_p2:'I\'d like to work through BGE 144 III 93',
    study_p3:'Explain the Subsumtion in Art. 41 OR',
    study_p4:'Here is my Urteilsbesprechung \u2014 feedback?',
    study_p5:'What if the tortfeasor had not acted unlawfully (widerrechtlich)?',
    study_p6:'Review cards for the requirements of Gesch\u00e4ftsf\u00fchrung ohne Auftrag',
    hero_mcp:'Search with AI',
    nav_health:'Health', health_title:'Scraper Health', th_status:'Status', th_new:'New', th_duration:'Duration', th_state:'Total Known', th_jsonl_size:'JSONL', th_last_data:'Last Data', health_run_at:'Last run', health_ok:'OK', health_fail:'Failed', health_investigating:'Investigating', health_running:'Still running', health_stale:'Stale', health_errors:'errors', health_unavail:'skipped', health_unavail_tip:'Decisions listed in portal index but content not downloadable (empty page or missing PDF)', health_disk:'Storage', health_disk_free:'free',
  },
};

let curLang = localStorage.getItem('lang') || 'de';
function t(key) { return (I18N[curLang]||I18N.de)[key] || I18N.de[key] || key; }

function applyI18n() {
  document.documentElement.lang = curLang === 'en' ? 'en' : curLang;
  document.querySelectorAll('[data-t]').forEach(el => {
    const val = t(el.dataset.t);
    if (/<[a-z]/.test(val)) el.innerHTML = val; else el.textContent = val;
  });
  document.querySelectorAll('[data-t-placeholder]').forEach(el => {
    el.placeholder = t(el.dataset.tPlaceholder || el.getAttribute('data-t-placeholder'));
  });
  if (window._statsData) renderAll(window._statsData);
}

document.querySelectorAll('.lang-sw button').forEach(btn => {
  btn.addEventListener('click', () => {
    curLang = btn.dataset.l;
    localStorage.setItem('lang', curLang);
    document.querySelectorAll('.lang-sw button').forEach(b => b.classList.remove('on'));
    btn.classList.add('on');
    applyI18n();
  });
  btn.classList.toggle('on', btn.dataset.l === curLang);
});

let themePref = localStorage.getItem('theme') ||
  (matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
function applyTheme() {
  const isDark = themePref === 'dark';
  document.documentElement.dataset.theme = isDark ? 'dark' : 'light';
  document.getElementById('ico-sun').style.display = isDark ? 'none' : '';
  document.getElementById('ico-moon').style.display = isDark ? '' : 'none';
  if (window._statsData) { destroyCharts(); renderCharts(window._statsData); }
}
applyTheme();
document.getElementById('theme-btn').addEventListener('click', () => {
  themePref = themePref === 'dark' ? 'light' : 'dark';
  localStorage.setItem('theme', themePref);
  applyTheme();
});

/* ── Hamburger toggle ── */
const hamburgerBtn = document.getElementById('hamburger-btn');
const mobileMenu = document.getElementById('mobile-menu');
if (hamburgerBtn && mobileMenu) {
  const icoMenu = hamburgerBtn.querySelector('.ico-menu');
  const icoClose = hamburgerBtn.querySelector('.ico-close');
  const toggleMenu = (open) => {
    const isOpen = open !== undefined ? open : !mobileMenu.classList.contains('open');
    mobileMenu.classList.toggle('open', isOpen);
    if (icoMenu) icoMenu.style.display = isOpen ? 'none' : '';
    if (icoClose) icoClose.style.display = isOpen ? '' : 'none';
    document.body.style.overflow = isOpen ? 'hidden' : '';
  };
  hamburgerBtn.addEventListener('click', () => toggleMenu());
  mobileMenu.querySelectorAll('a').forEach(a => {
    a.addEventListener('click', () => toggleMenu(false));
  });
}

/* ── Scroll-spy ── */
{
  const navLinks = document.querySelectorAll('#section-nav a, #mobile-menu a');
  const sectionIds = [...new Set([...document.querySelectorAll('#section-nav a')].map(a => a.getAttribute('href').slice(1)))];
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const id = entry.target.id;
        navLinks.forEach(a => {
          a.classList.toggle('active', a.getAttribute('href') === '#' + id);
        });
      }
    });
  }, { rootMargin: '-20% 0px -70% 0px' });
  sectionIds.forEach(id => {
    const el = document.getElementById(id);
    if (el) observer.observe(el);
  });
}

const FED = new Set(['bger','bge','bvger','bstger','bpatger','weko','finma','edoeb','ch_vb','ta_sst','ch_bundesrat','bge_egmr']);
const CANTON_NAMES = {
  AG:'Aargau', AI:'Appenzell I.Rh.', AR:'Appenzell A.Rh.',
  BE:'Bern', BL:'Basel-Land', BS:'Basel-Stadt', FR:'Fribourg',
  GE:'Gen\u00e8ve', GL:'Glarus', GR:'Graub\u00fcnden', JU:'Jura',
  LU:'Luzern', NE:'Neuch\u00e2tel', NW:'Nidwalden', OW:'Obwalden',
  SG:'St. Gallen', SH:'Schaffhausen', SO:'Solothurn', SZ:'Schwyz',
  TG:'Thurgau', TI:'Ticino', UR:'Uri', VD:'Vaud', VS:'Valais', ZG:'Zug', ZH:'Z\u00fcrich',
};
const ALL_CANTONS = ['ZH','BE','LU','UR','SZ','OW','NW','GL','ZG','FR',
  'SO','BS','BL','SH','AR','AI','SG','GR','AG','TG','TI','VD','VS','NE','GE','JU'];
const LANG_NAMES = { de:'Deutsch', fr:'Fran\u00e7ais', it:'Italiano', rm:'Rumantsch' };

/* \u2500\u2500 Court display names {de, fr, en}; it\u2192fr fallback, rm\u2192de fallback \u2500\u2500 */
const COURT_DISPLAY = {
  // Federal
  bger:       {de:'Bundesgericht',              fr:'Tribunal f\u00e9d\u00e9ral',              en:'Federal Supreme Court'},
  bge:        {de:'BGE Leitentscheide',         fr:'ATF',                           en:'Leading Decisions (BGE)'},
  bvger:      {de:'Bundesverwaltungsgericht',   fr:'TAF',                           en:'Federal Administrative Court'},
  bstger:     {de:'Bundesstrafgericht',         fr:'TPF',                           en:'Federal Criminal Court'},
  bpatger:    {de:'Bundespatentgericht',        fr:'TFB',                           en:'Federal Patent Court'},
  weko:       {de:'WEKO',                       fr:'COMCO',                         en:'Competition Commission'},
  finma:      {de:'FINMA',                      fr:'FINMA',                         en:'FINMA'},
  edoeb:      {de:'ED\u00d6B',                       fr:'PFPDT',                         en:'Data Protection Commissioner'},
  ch_vb:      {de:'VPB (1982\u20132016)',              fr:'JAAC (1982\u20132016)',                    en:'Federal Admin. Practice (1982\u20132016)'},
  ta_sst:     {de:'Sportschiedsgericht',         fr:'Tribunal arbitral du sport',    en:'Sports Tribunal'},
  ch_bundesrat:{de:'Bundesrat',                 fr:'Conseil f\u00e9d\u00e9ral',               en:'Federal Council'},
  bge_egmr:   {de:'EGMR',                      fr:'CEDH',                          en:'ECHR'},
  // AG
  ag_gerichte:                {de:'Obergericht',               fr:'Tribunal sup\u00e9rieur',                    en:'High Court'},
  ag_verwaltungsgericht:      {de:'Verwaltungsgericht',        fr:'Tribunal administratif',                en:'Administrative Court'},
  ag_strafgericht:            {de:'Strafgericht',              fr:'Tribunal p\u00e9nal',                        en:'Criminal Court'},
  ag_versicherungsgericht:    {de:'Versicherungsgericht',      fr:'Tribunal des assurances',               en:'Insurance Court'},
  ag_zivilgericht:            {de:'Zivilgericht',              fr:'Tribunal civil',                        en:'Civil Court'},
  ag_handelsgericht:          {de:'Handelsgericht',            fr:'Tribunal de commerce',                  en:'Commercial Court'},
  ag_spezialverwaltungsgericht:{de:'Spezialverwaltungsgericht',fr:'Tribunal administratif sp\u00e9cialis\u00e9',     en:'Specialised Admin. Court'},
  ag_regierungsrat:           {de:'Regierungsrat',             fr:'Conseil d\'\u00c9tat',                       en:'Cantonal Government'},
  ag_departement_bvu:         {de:'Departement BVU',           fr:'D\u00e9partement BVU',                       en:'Dept. Construction & Transport'},
  ag_departement_vi:          {de:'Departement Volkswirtschaft & Inneres',fr:'D\u00e9partement \u00c9conomie & Int\u00e9rieur',en:'Dept. Economy & Interior'},
  ag_departement_gs:          {de:'Departement Gesundheit & Soziales',fr:'D\u00e9partement Sant\u00e9 & Social',     en:'Dept. Health & Social Affairs'},
  ag_departement_bks:         {de:'Departement BKS',           fr:'D\u00e9partement BKS',                       en:'Dept. Education & Culture'},
  ag_anwaltskommission:       {de:'Anwaltskommission',         fr:'Commission des avocats',                en:'Bar Commission'},
  ag_aufsichtskommission:     {de:'Aufsichtskommission',       fr:'Commission de surveillance',            en:'Supervisory Commission'},
  ag_baugesetzgebung:         {de:'Baugesetzgebung',            fr:'L\u00e9gislation de la construction',       en:'Building Legislation'},
  ag_justizgericht:           {de:'Justizgericht',             fr:'Tribunal de la justice',                en:'Court of Justice'},
  ag_justizleitung:           {de:'Justizleitung',             fr:'Direction de la justice',               en:'Justice Directorate'},
  ag_weitere:                 {de:'Weitere Gerichte',          fr:'Autres tribunaux',                      en:'Other Courts'},
  // AI
  ai_gerichte:                {de:'Gerichte',                  fr:'Tribunaux',                             en:'Courts'},
  // AR
  ar_gerichte:                {de:'Obergericht',               fr:'Tribunal sup\u00e9rieur',                    en:'High Court'},
  // BE
  be_verwaltungsgericht:      {de:'Verwaltungsgericht',        fr:'Tribunal administratif',                en:'Administrative Court'},
  be_zivilstraf:              {de:'Obergericht (Zivil/Straf)', fr:'Tribunal sup\u00e9rieur (civil/p\u00e9nal)',      en:'High Court (Civil/Criminal)'},
  be_anwaltsaufsicht:         {de:'Anwaltsaufsicht',           fr:'Surveillance des avocats',              en:'Bar Supervision'},
  be_bvd:                     {de:'BVD (Bau/Verkehr/Energie)', fr:'BVD',                                   en:'BVD (Construction/Transport/Energy)'},
  be_steuerrekurs:            {de:'Steuerrekurskommission',    fr:'Commission de recours fiscal',          en:'Tax Appeal Commission'},
  be_weitere:                 {de:'Weitere Gerichte',          fr:'Autres tribunaux',                      en:'Other Courts'},
  // BL
  bl_gerichte:                {de:'Kantonsgericht',            fr:'Tribunal cantonal',                     en:'Cantonal Court'},
  // BS
  bs_appellationsgericht:     {de:'Appellationsgericht',       fr:'Cour d\'appel',                         en:'Court of Appeal'},
  bs_sozialversicherungsgericht:{de:'Sozialversicherungsgericht',fr:'Tribunal des assurances sociales',    en:'Social Insurance Court'},
  // FR
  fr_gerichte:                {de:'Kantonsgericht',            fr:'Tribunal cantonal',                     en:'Cantonal Court'},
  // GE
  ge_gerichte:                {de:'Justiz',                    fr:'Pouvoir judiciaire',                    en:'Judiciary'},
  // GL
  gl_gerichte:                {de:'Obergericht',               fr:'Tribunal sup\u00e9rieur',                    en:'High Court'},
  // GR
  gr_gerichte:                {de:'Kantonsgericht',            fr:'Tribunal cantonal',                     en:'Cantonal Court'},
  // JU
  ju_gerichte:                {de:'Gerichte',                  fr:'Tribunaux',                             en:'Courts'},
  // LU
  lu_gerichte:                {de:'Kantonsgericht',            fr:'Tribunal cantonal',                     en:'Cantonal Court'},
  // NE
  ne_gerichte:                {de:'Gerichte',                  fr:'Tribunaux',                             en:'Courts'},
  // NW
  nw_gerichte:                {de:'Gerichte',                  fr:'Tribunaux',                             en:'Courts'},
  // OW
  ow_gerichte:                {de:'Gerichte',                  fr:'Tribunaux',                             en:'Courts'},
  // SG
  sg_gerichte:                {de:'Kreisgericht',              fr:'Tribunal d\'arrondissement',             en:'District Court'},
  sg_publikationen:           {de:'Publikationen',             fr:'Publications',                          en:'Publications'},
  sg_versicherungsgericht:    {de:'Versicherungsgericht',      fr:'Tribunal des assurances',               en:'Insurance Court'},
  sg_verwaltungsgericht:      {de:'Verwaltungsgericht',        fr:'Tribunal administratif',                en:'Administrative Court'},
  sg_verwaltungsrekurskommission:{de:'Verwaltungsrekurskommission',fr:'Commission de recours administratif',en:'Admin. Appeals Commission'},
  sg_kantonsgericht:          {de:'Kantonsgericht',            fr:'Tribunal cantonal',                     en:'Cantonal Court'},
  sg_handelsgericht:          {de:'Handelsgericht',            fr:'Tribunal de commerce',                  en:'Commercial Court'},
  // SH
  sh_obergericht:             {de:'Obergericht (Archiv)',       fr:'Tribunal sup\u00e9rieur (archives)',          en:'High Court (archive)'},
  sh_gerichte:                {de:'Obergericht (aktuell)',      fr:'Tribunal sup\u00e9rieur (actuel)',           en:'High Court (current)'},
  // SO
  so_gerichte:                {de:'Obergericht',               fr:'Tribunal sup\u00e9rieur',                    en:'High Court'},
  // SZ
  sz_gerichte:                {de:'Kantonsgericht',            fr:'Tribunal cantonal',                     en:'Cantonal Court'},
  sz_verwaltungsgericht:      {de:'Verwaltungsgericht',        fr:'Tribunal administratif',                en:'Administrative Court'},
  // TG
  tg_obergericht:             {de:'Obergericht (Archiv)',       fr:'Tribunal sup\u00e9rieur (archives)',          en:'High Court (archive)'},
  tg_gerichte:                {de:'Obergericht / TVR',          fr:'Tribunal sup\u00e9rieur / TVR',              en:'High Court / TVR'},
  // TI
  ti_gerichte:                {de:'Gerichte',                  fr:'Tribunaux',                              it:'Tribunali',en:'Courts'},
  // UR
  ur_gerichte:                {de:'Obergericht',               fr:'Tribunal sup\u00e9rieur',                    en:'High Court'},
  // VD
  vd_findinfo:                {de:'FindInfo-Archiv (ab 2008)',  fr:'Archives FindInfo (d\u00e8s 2008)',          en:'FindInfo Archive (2008+)'},
  vd_gerichte:                {de:'Kantonsgericht (aktuell)',   fr:'Tribunal cantonal (actuel)',             en:'Cantonal Court (current)'},
  vd_omni:                    {de:'Jurisweb-Archiv (vor 2008)',fr:'Archives Jurisweb (avant 2008)',         en:'Jurisweb Archive (pre-2008)'},
  // VS
  vs_gerichte:                {de:'Kantonsgericht',            fr:'Tribunal cantonal',                     en:'Cantonal Court'},
  // ZG
  zg_verwaltungsgericht:      {de:'Verwaltungsgericht',        fr:'Tribunal administratif',                en:'Administrative Court'},
  zg_obergericht:             {de:'Obergericht',               fr:'Tribunal sup\u00e9rieur',                    en:'High Court'},
  // ZH
  zh_gerichte:                {de:'Obergericht',               fr:'Tribunal sup\u00e9rieur',                    en:'High Court'},
  zh_obergericht:             {de:'Obergericht (alt)',         fr:'Tribunal sup\u00e9rieur (ancien)',            en:'High Court (legacy)'},
  zh_verwaltungsgericht:      {de:'Verwaltungsgericht',        fr:'Tribunal administratif',                en:'Administrative Court'},
  zh_sozialversicherungsgericht:{de:'Sozialversicherungsgericht',fr:'Tribunal des assurances sociales',    en:'Social Insurance Court'},
  zh_handelsgericht:          {de:'Handelsgericht',            fr:'Tribunal de commerce',                  en:'Commercial Court'},
  zh_kassationsgericht:       {de:'Kassationsgericht',         fr:'Cour de cassation',                     en:'Court of Cassation'},
  zh_baurekursgericht:        {de:'Baurekursgericht',          fr:'Tribunal des recours en construction',  en:'Building Appeals Court'},
  zh_steuerrekursgericht:     {de:'Steuerrekursgericht',       fr:'Tribunal des recours fiscaux',          en:'Tax Appeals Court'},
  zh_mietgericht:             {de:'Mietgericht',               fr:'Tribunal des baux',                     en:'Tenancy Court'},
  zh_bezirksgericht_zuerich:  {de:'Bezirksgericht Z\u00fcrich',     fr:'Tribunal de district de Zurich',        en:'District Court Zurich'},
  zh_bezirksgericht_winterthur:{de:'Bezirksgericht Winterthur',fr:'Tribunal de district de Winterthour',   en:'District Court Winterthur'},
  zh_bezirksgericht_dietikon: {de:'Bezirksgericht Dietikon',   fr:'Tribunal de district de Dietikon',      en:'District Court Dietikon'},
  zh_bezirksgericht_horgen:   {de:'Bezirksgericht Horgen',     fr:'Tribunal de district de Horgen',        en:'District Court Horgen'},
  zh_bezirksgericht_pfaeffikon:{de:'Bezirksgericht Pf\u00e4ffikon', fr:'Tribunal de district de Pf\u00e4ffikon',     en:'District Court Pf\u00e4ffikon'},
  zh_bezirksgericht_buelach:  {de:'Bezirksgericht B\u00fclach',     fr:'Tribunal de district de B\u00fclach',        en:'District Court B\u00fclach'},
  zh_bezirksgericht_meilen:   {de:'Bezirksgericht Meilen',     fr:'Tribunal de district de Meilen',        en:'District Court Meilen'},
  zh_bezirksgericht_dielsdorf:{de:'Bezirksgericht Dielsdorf',  fr:'Tribunal de district de Dielsdorf',     en:'District Court Dielsdorf'},
  zh_bezirksgericht_hinwil:   {de:'Bezirksgericht Hinwil',     fr:'Tribunal de district de Hinwil',        en:'District Court Hinwil'},
  zh_bezirksgericht_uster:    {de:'Bezirksgericht Uster',      fr:'Tribunal de district d\'Uster',         en:'District Court Uster'},
  zh_bezirksgericht_affoltern:{de:'Bezirksgericht Affoltern',  fr:'Tribunal de district d\'Affoltern',     en:'District Court Affoltern'},
};

function fmt(n) { return n != null ? n.toLocaleString('de-CH') : '\u2014'; }
function fmtDate(iso) {
  if (!iso || iso === '0000-00-00') return '\u2014';
  try {
    const d = new Date(iso.slice(0,10) + 'T00:00:00');
    if (isNaN(d)) return iso;
    const loc = { de:'de-CH', fr:'fr-CH', it:'it-CH', en:'en-GB' }[curLang] || 'de-CH';
    return d.toLocaleDateString(loc, { day:'numeric', month:'short', year:'numeric' });
  } catch { return iso; }
}
function ltags(ls) { return (ls||[]).map(l => `<span class="lg">${l}</span>`).join(''); }
function courtName(code, canton) {
  const d = COURT_DISPLAY[code];
  let name = d ? (d[curLang] || d.it || d.fr || d.de || code) : code.replace(/_/g,' ');
  if (canton) name += ' (' + canton + ')';
  return name;
}
function getCSS(v) { return getComputedStyle(document.documentElement).getPropertyValue(v).trim(); }

let _charts = [];
function destroyCharts() { _charts.forEach(c => c.destroy()); _charts = []; }

function renderCharts(data) {
  const by_year = data.by_year || {};
  const currentYear = new Date().getFullYear();
  const years = Object.keys(by_year).filter(y => +y >= 1954 && +y <= currentYear).sort();
  const counts = years.map(y => by_year[y]);

  const tx3 = getCSS('--tx3');
  const brd2 = getCSS('--brd2');
  const barColor = getCSS('--bar');
  const barHover = getCSS('--bar-hover');
  const chartColors = [getCSS('--chart-1'), getCSS('--chart-2'), getCSS('--chart-3'), getCSS('--chart-4')];

  Chart.defaults.font.family = getCSS('--f-sans');
  Chart.defaults.color = tx3;

  // Timeline bar chart
  const ctx1 = document.getElementById('c-timeline');
  if (ctx1) {
    _charts.push(new Chart(ctx1, {
      type: 'bar',
      data: {
        labels: years,
        datasets: [{
          data: counts,
          backgroundColor: barColor,
          hoverBackgroundColor: barHover,
          borderRadius: 2,
          borderSkipped: false,
        }]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { display: false }, tooltip: {
          callbacks: { label: ctx => fmt(ctx.raw) + ' ' + t('kpi_decisions').toLowerCase() }
        }},
        scales: {
          x: { grid: { display: false }, ticks: { maxTicksLimit: 12, font: { size: 10 } } },
          y: { grid: { color: brd2 }, ticks: { callback: v => v >= 1000 ? (v/1000)+'k' : v, font: { size: 10 } }, beginAtZero: true }
        }
      }
    }));
  }

  // Language donut
  const by_lang = data.by_language || {};
  const langKeys = Object.keys(by_lang).sort((a,b) => by_lang[b] - by_lang[a]);
  const langVals = langKeys.map(k => by_lang[k]);
  const langTotal = langVals.reduce((a,b) => a+b, 0);
  const langColors = langKeys.map((_, i) => chartColors[i % chartColors.length]);

  const ctx2 = document.getElementById('c-lang');
  if (ctx2) {
    _charts.push(new Chart(ctx2, {
      type: 'doughnut',
      data: {
        labels: langKeys.map(k => LANG_NAMES[k] || k),
        datasets: [{ data: langVals, backgroundColor: langColors, borderWidth: 0, hoverOffset: 4 }]
      },
      options: {
        responsive: true, maintainAspectRatio: true, cutout: '65%',
        plugins: { legend: { display: false }, tooltip: {
          callbacks: { label: ctx => fmt(ctx.raw) + ' (' + ((ctx.raw/langTotal)*100).toFixed(1) + '%)' }
        }}
      }
    }));
  }

  // Language legend
  const legendEl = document.getElementById('lang-legend');
  if (legendEl) {
    legendEl.innerHTML = langKeys.map((k, i) => `
      <div class="lang-legend-item">
        <span class="lang-dot" style="background:${langColors[i]}"></span>
        <span>${LANG_NAMES[k] || k}</span>
        <span class="lang-pct">${((by_lang[k]/langTotal)*100).toFixed(1)}%</span>
      </div>
    `).join('');
  }

}

function sortable(tbl, data, renderRow, defKey='count') {
  let key = defKey, asc = false;
  const ths = tbl.querySelectorAll('thead th[data-k]');
  const tb = tbl.querySelector('tbody');
  tbl._sortData = data; // expose for search filter
  tbl._renderRow = renderRow;
  function render(filteredData) {
    const src = filteredData || data;
    const s = [...src].sort((a, b) => {
      let va = a[key], vb = b[key];
      if (va == null) va = ''; if (vb == null) vb = '';
      if (typeof va === 'string') { va = va.toLowerCase(); vb = vb.toLowerCase(); }
      return (va < vb ? -1 : va > vb ? 1 : 0) * (asc ? 1 : -1);
    });
    tb.innerHTML = s.map(renderRow).join('');
    ths.forEach(h => {
      const active = h.dataset.k === key;
      h.classList.toggle('s', active);
      const arr = h.querySelector('.arr');
      if (arr) arr.textContent = active ? (asc ? '\u25B2' : '\u25BC') : '\u25BC';
    });
    return s.length;
  }
  ths.forEach(h => {
    if (!h.dataset.k) return;
    const arr = document.createElement('span');
    arr.className = 'arr'; arr.textContent = '\u25BC'; h.appendChild(arr);
    h.addEventListener('click', () => {
      const k = h.dataset.k;
      if (key === k) asc = !asc; else { key = k; asc = k !== 'count'; }
      render(tbl._filteredData);
    });
  });
  tbl._render = render;
  render();
}

/* ── Table search filter ── */
function setupTableSearch(inputId, countId, tbl) {
  const input = document.getElementById(inputId);
  const countEl = document.getElementById(countId);
  if (!input || !tbl || !tbl._render) return;
  input.addEventListener('input', () => {
    const q = input.value.toLowerCase().trim();
    if (!q) {
      tbl._filteredData = null;
      const n = tbl._render();
      countEl.textContent = '';
    } else {
      tbl._filteredData = tbl._sortData.filter(r =>
        (r.name || '').toLowerCase().includes(q) ||
        (r.court || '').toLowerCase().includes(q) ||
        (r.canton || '').toLowerCase().includes(q) ||
        (r.cantonName || '').toLowerCase().includes(q)
      );
      const n = tbl._render(tbl._filteredData);
      countEl.textContent = n + '/' + tbl._sortData.length;
    }
  });
}

/* ── CSV export ── */
function exportCSV(data, filename) {
  if (!data || !data.length) return;
  const keys = Object.keys(data[0]);
  const lines = [keys.join(',')];
  data.forEach(r => {
    lines.push(keys.map(k => {
      let v = r[k];
      if (Array.isArray(v)) v = v.join(';');
      if (typeof v === 'string' && (v.includes(',') || v.includes('"'))) v = '"' + v.replace(/"/g, '""') + '"';
      return v != null ? v : '';
    }).join(','));
  });
  const blob = new Blob([lines.join('\n')], { type: 'text/csv;charset=utf-8;' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = filename;
  a.click();
  URL.revokeObjectURL(a.href);
}

function deltaTag(n) { return n > 0 ? `<span class="delta">+${fmt(n)}</span>` : ''; }

function renderAll(data) {
  const range = data.date_range || {};
  const cantonCount = (data.by_canton || []).length;

  // KPIs — two hero numbers
  const dl = data.delta || {};
  document.getElementById('kpis').innerHTML = `
    <div class="kpi"><div class="kpi-v">${fmt(data.total)}${deltaTag(dl.total)}</div><div class="kpi-l">${t('kpi_decisions')}</div></div>
    <div class="kpi"><div class="kpi-v">${fmt(data.court_count || 0)}</div><div class="kpi-l">${t('kpi_courts')}</div></div>
    <div class="kpi"><div class="kpi-v">${cantonCount}</div><div class="kpi-l">${t('kpi_cantons')}</div></div>`;

  // Last Updated — prominent, below KPIs
  if (data.generated_at) {
    const d = new Date(data.generated_at);
    const loc = { de:'de-CH', fr:'fr-CH', it:'it-CH', en:'en-GB' }[curLang] || 'de-CH';
    const updEl = document.getElementById('last-updated');
    updEl.textContent = `${t('updated')} ${d.toLocaleDateString(loc, { day:'numeric', month:'long', year:'numeric' })}`;
    updEl.classList.remove('hid');
  }

  const all = data.by_court || [];
  const fed = all.filter(c => c.canton === 'CH' || FED.has(c.court));
  const can = all.filter(c => c.canton !== 'CH' && !FED.has(c.court));

  if (fed.length) {
    const fedDelta = fed.reduce((s, c) => s + (dl.by_court?.[c.court] || 0), 0);
    document.getElementById('fed-n').innerHTML = fmt(fed.reduce((s, c) => s + c.count, 0)) + deltaTag(fedDelta);
    sortable(document.getElementById('t-fed'), fed.map(c => ({ ...c, name: courtName(c.court) })), r => `<tr>
      <td><span class="cn">${r.name}</span><span class="cc">${r.court}</span></td>
      <td class="n">${fmt(r.count)}${deltaTag(dl.by_court?.[r.court])}</td>
      <td class="d hide-m">${fmtDate(r.last_scraped)}</td>
      <td>${ltags(r.languages)}</td></tr>`);
    const fedEl = document.getElementById('sec-fed');
    fedEl.classList.remove('hid'); fedEl.open = true;
  }

  if (can.length) {
    const canDelta = can.reduce((s, c) => s + (dl.by_court?.[c.court] || 0), 0);
    document.getElementById('can-n').innerHTML = fmt(can.reduce((s, c) => s + c.count, 0)) + deltaTag(canDelta);
    const canData = can.map(c => ({
      ...c, name: courtName(c.court, c.canton),
      cantonName: CANTON_NAMES[c.canton] || c.canton,
    }));
    sortable(document.getElementById('t-can'), canData, r => `<tr>
      <td><span class="cn">${r.name}</span><span class="cc">${r.court}</span></td>
      <td>${r.cantonName}</td>
      <td class="n">${fmt(r.count)}${deltaTag(dl.by_court?.[r.court])}</td>
      <td class="d hide-m">${fmtDate(r.last_scraped)}</td></tr>`);
    const canEl = document.getElementById('sec-can');
    canEl.classList.remove('hid'); canEl.open = true;

    // Setup search filter
    setupTableSearch('can-search', 'can-search-count', document.getElementById('t-can'));

    // CSV export
    document.getElementById('csv-can').addEventListener('click', () => {
      exportCSV(canData.map(r => ({ court: r.court, canton: r.canton, name: r.name, count: r.count, last_scraped: r.last_scraped })), 'cantonal_courts.csv');
    });
  }

  // Canton grid
  const cm = {};
  (data.by_canton || []).forEach(c => { cm[c.canton] = c; });
  document.getElementById('canton-grid').innerHTML = ALL_CANTONS.map(code => {
    const e = cm[code], v = e ? e.count : 0;
    const langs = e && e.languages && e.languages.length ? e.languages.map(l => `<span class="lg">${l}</span>`).join('') : '';
    const courts = e && e.court_count ? `<span style="font-size:var(--fs-2xs);color:var(--tx3)">${e.court_count}</span>` : '';
    return `<div class="cc2${v ? '' : ' empty'}">
      <div class="k">${code}</div><div class="nm">${CANTON_NAMES[code]||code}</div>
      <div class="cv">${v ? fmt(v) : '\u2014'}${deltaTag(dl.by_canton?.[code])}</div>
      ${langs || courts ? `<div class="canton-meta">${courts}${langs}</div>` : ''}
      </div>`;
  }).join('');
  const cantonsEl = document.getElementById('sec-cantons');
  cantonsEl.classList.remove('hid'); cantonsEl.open = true;

  // Tree browser — group courts by canton/federal
  const treeEl = document.getElementById('tree-browser');
  const groups = {};
  // Federal first, then cantons in ALL_CANTONS order
  all.forEach(c => {
    const key = (c.canton === 'CH' || FED.has(c.court)) ? 'CH' : c.canton;
    if (!groups[key]) groups[key] = [];
    groups[key].push(c);
  });
  const treeOrder = ['CH', ...ALL_CANTONS];
  const CANTON_ALL = { CH: 'Bund / Conf\u00e9d\u00e9ration', ...CANTON_NAMES };
  treeEl.innerHTML = treeOrder.filter(k => groups[k]).map(key => {
    const courts = groups[key].sort((a, b) => b.count - a.count);
    const total = courts.reduce((s, c) => s + c.count, 0);
    const groupDelta = courts.reduce((s, c) => s + (dl.by_court?.[c.court] || 0), 0);
    const kids = courts.map(c => `
      <div class="tree-court">
        <span class="tree-icon">\u2501</span>
        <span class="tree-label">${courtName(c.court)}<span class="tree-code">${c.court}</span></span>
        <span class="tree-count">${fmt(c.count)}${deltaTag(dl.by_court?.[c.court])}</span>
      </div>`).join('');
    return `<div class="tree-node">
      <div class="tree-hd">
        <span class="tree-arrow">\u25B6</span>
        <span class="tree-icon">\u25A0</span>
        <span class="tree-label">${CANTON_ALL[key] || key}<span class="tree-code">${key}</span></span>
        <span class="tree-count">${fmt(total)}${deltaTag(groupDelta)}</span>
      </div>
      <div class="tree-kids">${kids}</div>
    </div>`;
  }).join('');
  treeEl.querySelectorAll('.tree-hd').forEach(hd => {
    hd.addEventListener('click', () => hd.parentElement.classList.toggle('open'));
  });
  const treeDetailEl = document.getElementById('sec-tree');
  treeDetailEl.classList.remove('hid'); treeDetailEl.open = true;

  // Scraper health
  const sh = data.scraper_health;
  if (sh && sh.scrapers) {
    const NOW = Date.now();
    const SEVEN_DAYS = 7 * 24 * 3600 * 1000;
    const scrapers = Object.entries(sh.scrapers).map(([code, s]) => {
      let status = s.timed_out ? 'running' : s.success ? 'ok' : 'investigating';
      if (s.success && s.new_count === 0 && s.jsonl_mtime) {
        const age = NOW - new Date(s.jsonl_mtime).getTime();
        if (age > SEVEN_DAYS) status = 'stale';
      }
      return {
        code, name: courtName(code),
        status, status_ord: status === 'ok' ? 0 : status === 'running' ? 0.5 : status === 'stale' ? 1 : status === 'investigating' ? 2 : 3,
        new_count: s.new_count || 0,
        error_count: s.error_count || 0,
        none_count: s.none_count || 0,
        duration_s: s.duration_s || 0,
        timed_out: s.timed_out || false,
        state_count: s.state_count,
        jsonl_size_mb: s.jsonl_size_mb,
        jsonl_mtime: s.jsonl_mtime,
        error: s.timed_out ? null : s.error,
        note: s.note,
      };
    });

    const okCount = scrapers.filter(s => s.status === 'ok' || s.status === 'running').length;
    // Summary status badge on collapsed card
    const statusParts = [`${okCount}/${scrapers.length} ${t('health_ok')}`];
    if (sh.run_at) {
      const rd = new Date(sh.run_at);
      const loc = { de:'de-CH', fr:'fr-CH', it:'it-CH', en:'en-GB' }[curLang] || 'de-CH';
      statusParts.push(rd.toLocaleDateString(loc, { day:'numeric', month:'short' }));
    }
    document.getElementById('health-summary-status').textContent = statusParts.join(' \u2014 ');

    // Meta line: last run info (inside expanded body)
    if (sh.run_at) {
      const rd = new Date(sh.run_at);
      const loc = { de:'de-CH', fr:'fr-CH', it:'it-CH', en:'en-GB' }[curLang] || 'de-CH';
      const durMin = sh.run_duration_s ? Math.round(sh.run_duration_s / 60) : 0;
      const metaEl = document.getElementById('health-meta');
      metaEl.textContent = `${t('health_run_at')}: ${rd.toLocaleDateString(loc, { day:'numeric', month:'short', year:'numeric' })}, ${durMin} min`;
      metaEl.classList.remove('hid');
    }

    // Disk usage bar
    if (sh.disk) {
      const vol = sh.disk.data_volume || sh.disk.repo;
      if (vol) {
        const pct = vol.used_percent;
        const cls = pct >= 95 ? 'critical' : pct >= 85 ? 'warn' : 'ok';
        const label = `${t('health_disk')}: ${vol.used_gb} / ${vol.total_gb} GB (${pct}%)` +
          (pct >= 85 ? ` — ${vol.free_gb} GB ${t('health_disk_free')}` : '');
        const el = document.getElementById('disk-bar');
        el.innerHTML = `${label}<div class="disk-track"><div class="disk-fill ${cls}" style="width:${pct}%"></div></div>`;
        el.classList.remove('hid');
      }
    }

    function fmtDur(s) {
      if (s == null) return '\u2014';
      if (s < 60) return Math.round(s) + 's';
      if (s < 3600) return Math.floor(s/60) + 'm ' + Math.round(s%60) + 's';
      return Math.floor(s/3600) + 'h ' + Math.round((s%3600)/60) + 'm';
    }

    const pillLabel = { ok: t('health_ok'), fail: t('health_fail'), investigating: t('health_investigating'), running: t('health_running'), stale: t('health_stale') };
    sortable(document.getElementById('t-health'), scrapers, r => {
      const pill = `<span class="pill pill-${r.status}">${pillLabel[r.status]}</span>`;
      const errBadge = r.error_count > 0 ? ` <span class="cc" style="color:var(--ac)">${r.error_count} ${t('health_errors')}</span>` : '';
      const noneBadge = r.none_count > 0 ? ` <span class="cc" style="color:var(--tx2)" title="${t('health_unavail_tip')}">${r.none_count} ${t('health_unavail')}</span>` : '';
      const mtime = fmtDate(r.jsonl_mtime);
      const noteHtml = r.note ? `<br><span class="cc" style="color:var(--tx2);font-size:.75rem">${r.note}</span>` : '';
      const errDetail = r.error ? `<br><span class="cc" style="color:var(--ac);font-size:.75rem">${r.error.replace(/"/g,'&quot;').slice(0,120)}</span>` : '';
      const dur = r.timed_out ? '>' + fmtDur(r.duration_s) : fmtDur(r.duration_s);
      return `<tr>
        <td><span class="cn">${r.name}</span><span class="cc">${r.code}</span></td>
        <td>${pill}${errBadge}${noneBadge}${errDetail}${noteHtml}</td>
        <td class="n">${r.new_count > 0 ? '+' + fmt(r.new_count) : '0'}</td>
        <td class="n">${dur}</td>
        <td class="n hide-m">${r.state_count != null ? fmt(r.state_count) : '\u2014'}</td>
        <td class="n hide-m">${r.jsonl_size_mb != null ? r.jsonl_size_mb + ' MB' : '\u2014'}</td>
        <td class="d hide-m">${mtime}</td></tr>`;
    }, 'status_ord');
    document.getElementById('sec-health').classList.remove('hid');
  }

  // Footer timestamp
  if (data.generated_at) {
    const d = new Date(data.generated_at);
    const loc = { de:'de-CH', fr:'fr-CH', it:'it-CH', en:'en-GB' }[curLang] || 'de-CH';
    document.getElementById('ts').textContent =
      `${t('updated')} ${d.toLocaleDateString(loc, { day:'numeric', month:'long', year:'numeric' })}`;
  }
}

async function init() {
  applyI18n();
  try {
    const r = await fetch('stats.json?v=' + Math.floor(Date.now()/60000));
    if (!r.ok) throw new Error(r.status);
    const data = await r.json();
    window._statsData = data;
    renderAll(data);
    renderCharts(data);
  } catch {
    document.getElementById('kpis').innerHTML =
      '<p class="ld" style="grid-column:1/-1">stats.json not found</p>';
  }

  // Copy buttons on code blocks (runs regardless of stats.json)
  document.querySelectorAll('.access-featured code, .access-card code').forEach(code => {
    const wrap = document.createElement('div');
    wrap.className = 'copy-wrap';
    code.parentNode.insertBefore(wrap, code);
    wrap.appendChild(code);
    const btn = document.createElement('button');
    btn.className = 'copy-btn';
    btn.textContent = 'Copy';
    btn.addEventListener('click', () => {
      navigator.clipboard.writeText(code.textContent.trim());
      btn.textContent = 'Copied!';
      setTimeout(() => btn.textContent = 'Copy', 1500);
    });
    wrap.appendChild(btn);
  });
}
init();
</script>
</body>
</html>
